â1
\C:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\AfpSqlServer.cs
	namespace

 	
Capa4_Persistencia


 
{ 
public 

class 
AfpSqlServer 
{ 
private 
readonly 
GestorSqlServer (
	gestorSQL) 2
;2 3
public 
AfpSqlServer 
( 
) 
{ 	
	gestorSQL 
= 
GestorSqlServer '
.' (
getInstance( 3
(3 4
)4 5
;5 6
} 	
public 
bool 
guardar 
( 
Afp 
afp  #
)# $
{ 	
string 
insertarAfp 
=  
$str! U
+V W
$str( C
;C D
try 
{ 

SqlCommand 
comando "
=# $
	gestorSQL% .
.. /
ObtenerComandoSQL/ @
(@ A
insertarAfpA L
)L M
;M N
comando   
.   

Parameters   "
.  " #
AddWithValue  # /
(  / 0
$str  0 5
,  5 6
afp  7 :
.  : ;
Afp_id  ; A
)  A B
;  B C
comando!! 
.!! 

Parameters!! "
.!!" #
AddWithValue!!# /
(!!/ 0
$str!!0 6
,!!6 7
afp!!8 ;
.!!; <
Nombre!!< B
)!!B C
;!!C D
comando"" 
."" 

Parameters"" "
.""" #
AddWithValue""# /
(""/ 0
$str""0 9
,""9 :
afp""; >
.""> ?
Porcentajedescuento""? R
)""R S
;""S T
comando## 
.## 
ExecuteNonQuery## '
(##' (
)##( )
;##) *
return$$ 
true$$ 
;$$ 
}&& 
catch'' 
('' 
	Exception'' 
err''  
)''  !
{(( 
Console** 
.** 
	WriteLine** !
(**! "
err**" %
.**% &
ToString**& .
(**. /
)**/ 0
)**0 1
;**1 2
throw++ 
;++ 
},, 
}-- 	
public// 
Afp// 
buscarAfpPorId// !
(//! "
int//" %
id//& (
)//( )
{00 	
string22 
consultaSQL22 
=22  
$str22! G
+22H I
id22J L
+22M N
$str22O R
;22R S
try33 
{44 
Afp55 
afp55 
=55 
null55 
;55 
SqlDataReader66 
resultadoSQL66 *
=66+ ,
	gestorSQL66- 6
.666 7
EjecutarConsulta667 G
(66G H
consultaSQL66H S
)66S T
;66T U
if77 
(77 
resultadoSQL77  
.77  !
Read77! %
(77% &
)77& '
)77' (
{88 
afp99 
=99 

obtenerAfp99 $
(99$ %
resultadoSQL99% 1
)991 2
;992 3
}:: 
return;; 
afp;; 
;;; 
}<< 
catch== 
(== 
	Exception== 
err==  
)==  !
{>> 
Console?? 
.?? 
	WriteLine?? !
(??! "
err??" %
.??% &
ToString??& .
(??. /
)??/ 0
)??0 1
;??1 2
throw@@ 
;@@ 
}AA 
}CC 	
publicEE 
ListEE 
<EE 
AfpEE 
>EE 
listaAfpEE !
(EE! "
)EE" #
{FF 	
ListGG 
<GG 
AfpGG 
>GG 
listaAfpGG 
=GG  
newGG! $
ListGG% )
<GG) *
AfpGG* -
>GG- .
(GG. /
)GG/ 0
;GG0 1
stringHH 
consultaSQLHH 
=HH  
$strHH! 4
;HH4 5
tryII 
{JJ 
SqlDataReaderKK 
resultadoSQLKK *
=KK+ ,
	gestorSQLKK- 6
.KK6 7
EjecutarConsultaKK7 G
(KKG H
consultaSQLKKH S
)KKS T
;KKT U
whileLL 
(LL 
resultadoSQLLL "
.LL" #
ReadLL# '
(LL' (
)LL( )
)LL) *
{MM 
listaAfpNN 
.NN 
AddNN  
(NN  !

obtenerAfpNN! +
(NN+ ,
resultadoSQLNN, 8
)NN8 9
)NN9 :
;NN: ;
}OO 
returnQQ 
listaAfpQQ 
;QQ  
}RR 
catchSS 
(SS 
	ExceptionSS 
errSS  
)SS  !
{TT 
ConsoleUU 
.UU 
	WriteLineUU !
(UU! "
errUU" %
.UU% &
ToStringUU& .
(UU. /
)UU/ 0
)UU0 1
;UU1 2
throwVV 
;VV 
}WW 
}YY 	
public[[ 
Afp[[ 

obtenerAfp[[ 
([[ 
SqlDataReader[[ +
	resultado[[, 5
)[[5 6
{\\ 	
Afp]] 
afp]] 
=]] 
new]] 
Afp]] 
(]] 
)]] 
;]]  
afp^^ 
.^^ 
Afp_id^^ 
=^^ 
	resultado^^ "
.^^" #
GetInt32^^# +
(^^+ ,
$num^^, -
)^^- .
;^^. /
afp__ 
.__ 
Nombre__ 
=__ 
	resultado__ "
.__" #
	GetString__# ,
(__, -
$num__- .
)__. /
;__/ 0
afp`` 
.`` 
Porcentajedescuento`` #
=``$ %
double``& ,
.``, -
Parse``- 2
(``2 3
	resultado``3 <
.``< =

GetDecimal``= G
(``G H
$num``H I
)``I J
.``J K
ToString``K S
(``S T
)``T U
)``U V
;``V W
returnaa 
afpaa 
;aa 
}cc 	
}ee 
}ff ∆e
eC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\BoletaDePagoSqlServer.cs
	namespace		 	
Capa4_Persistencia		
 
{

 
public 

class !
BoletaDePagoSqlServer &
{ 
private 
readonly 
GestorSqlServer (
	gestorSQL* 3
;3 4
public !
BoletaDePagoSqlServer $
($ %
)% &
{ 	
	gestorSQL 
= 
GestorSqlServer '
.' (
getInstance( 3
(3 4
)4 5
;5 6
} 	
public 
bool 
guardar 
( 
BoletaDePago (
boleta) /
)/ 0
{ 	
string 
insertarBoleta !
=" #
$str	$ í
+
ì î
$str	& è
+
ê ë
$str& Z
;Z [
try 
{ 

SqlCommand!! 
comando!! "
=!!# $
	gestorSQL!!% .
.!!. /
ObtenerComandoSQL!!/ @
(!!@ A
insertarBoleta!!A O
)!!O P
;!!P Q
comando"" 
."" 

Parameters"" "
.""" #
AddWithValue""# /
(""/ 0
$str""0 4
,""4 5
boleta""6 <
.""< =
	Boleta_id""= F
)""F G
;""G H
comando## 
.## 

Parameters## "
.##" #
AddWithValue### /
(##/ 0
$str##0 4
,##4 5
boleta##6 <
.##< =
Contrato##= E
.##E F
Contrato_id##F Q
)##Q R
;##R S
comando$$ 
.$$ 

Parameters$$ "
.$$" #
AddWithValue$$# /
($$/ 0
$str$$0 4
,$$4 5
boleta$$6 <
.$$< =
Nomina$$= C
.$$C D
	Nomina_id$$D M
)$$M N
;$$N O
comando%% 
.%% 

Parameters%% "
.%%" #
AddWithValue%%# /
(%%/ 0
$str%%0 4
,%%4 5
boleta%%6 <
.%%< =
Sueldobasico%%= I
)%%I J
;%%J K
comando&& 
.&& 

Parameters&& "
.&&" #
AddWithValue&&# /
(&&/ 0
$str&&0 4
,&&4 5
boleta&&6 <
.&&< =
Asignacionfamiliar&&= O
)&&O P
;&&P Q
comando'' 
.'' 

Parameters'' "
.''" #
AddWithValue''# /
(''/ 0
$str''0 4
,''4 5
boleta''6 <
.''< =
Montoporhoraextras''= O
)''O P
;''P Q
comando(( 
.(( 

Parameters(( "
.((" #
AddWithValue((# /
(((/ 0
$str((0 4
,((4 5
boleta((6 <
.((< =

Reintegros((= G
)((G H
;((H I
comando)) 
.)) 

Parameters)) "
.))" #
AddWithValue))# /
())/ 0
$str))0 4
,))4 5
boleta))6 <
.))< =
	Movilidad))= F
)))F G
;))G H
comando** 
.** 

Parameters** "
.**" #
AddWithValue**# /
(**/ 0
$str**0 4
,**4 5
boleta**6 <
.**< =
Otrosingresos**= J
)**J K
;**K L
comando++ 
.++ 

Parameters++ "
.++" #
AddWithValue++# /
(++/ 0
$str++0 5
,++5 6
boleta++7 =
.++= >
Regimenpensionario++> P
)++P Q
;++Q R
comando,, 
.,, 

Parameters,, "
.,," #
AddWithValue,,# /
(,,/ 0
$str,,0 5
,,,5 6
boleta,,7 =
.,,= > 
Montoporhorasdefalta,,> R
),,R S
;,,S T
comando-- 
.-- 

Parameters-- "
.--" #
AddWithValue--# /
(--/ 0
$str--0 5
,--5 6
boleta--7 =
.--= >
	Adelantos--> G
)--G H
;--H I
comando.. 
... 

Parameters.. "
..." #
AddWithValue..# /
(../ 0
$str..0 5
,..5 6
boleta..7 =
...= >
Otrosdescuentos..> M
)..M N
;..N O
comando// 
.// 
ExecuteNonQuery// '
(//' (
)//( )
;//) *
return00 
true00 
;00 
}22 
catch33 
(33 
	Exception33 
err33  
)33  !
{44 
Console66 
.66 
	WriteLine66 !
(66! "
err66" %
.66% &
ToString66& .
(66. /
)66/ 0
)660 1
;661 2
throw77 
;77 
}88 
}:: 	
public== 
List== 
<== 
BoletaDePago==  
>==  !
buscarPorIdNomina==" 3
(==3 4
Nomina==4 :
nomina==; A
)==A B
{>> 	
string@@ 
selectBoletas@@  
=@@! "
$str@@# S
+@@T U
nomina@@V \
.@@\ ]
	Nomina_id@@] f
+@@g h
$str@@i l
;@@l m
ListAA 
<AA 
BoletaDePagoAA 
>AA 
listaBoletasAA +
=AA, -
newAA. 1
ListAA2 6
<AA6 7
BoletaDePagoAA7 C
>AAC D
(AAD E
)AAE F
;AAF G
tryBB 
{CC 
SqlDataReaderDD 
resultadoSQLDD *
=DD+ ,
	gestorSQLDD- 6
.DD6 7
EjecutarConsultaDD7 G
(DDG H
selectBoletasDDH U
)DDU V
;DDV W
whileEE 
(EE 
resultadoSQLEE #
.EE# $
ReadEE$ (
(EE( )
)EE) *
)EE* +
{FF 
BoletaDePagoGG  
boletaDePagoGG! -
=GG. /
obtenerBoletaGG0 =
(GG= >
resultadoSQLGG> J
)GGJ K
;GGK L
boletaDePagoHH  
.HH  !
NominaHH! '
=HH( )
nominaHH* 0
;HH0 1
listaBoletasJJ  
.JJ  !
AddJJ! $
(JJ$ %
boletaDePagoJJ% 1
)JJ1 2
;JJ2 3
}KK 
returnNN 
listaBoletasNN #
;NN# $
}OO 
catchPP 
(PP 
	ExceptionPP 
errPP  
)PP  !
{QQ 
ConsoleRR 
.RR 
	WriteLineRR !
(RR! "
errRR" %
.RR% &
ToStringRR& .
(RR. /
)RR/ 0
)RR0 1
;RR1 2
throwSS 
;SS 
}TT 
}VV 	
publicYY 
voidYY 
eliminarPorIdNominaYY '
(YY' (
stringYY( .
idYY/ 1
)YY1 2
{ZZ 	
try\\ 
{]] 
string^^ 
eliminarSql^^ "
=^^# $
$str^^% T
+^^U V
id^^W Y
+^^Z [
$str^^\ _
;^^_ `

SqlCommand`` 
comando`` "
=``# $
	gestorSQL``% .
.``. /
ObtenerComandoSQL``/ @
(``@ A
eliminarSql``A L
)``L M
;``M N
comandoaa 
.aa 
ExecuteNonQueryaa '
(aa' (
)aa( )
;aa) *
}bb 
catchcc 
(cc 
	Exceptioncc 
errcc  
)cc  !
{dd 
Consoleff 
.ff 
	WriteLineff !
(ff! "
errff" %
.ff% &
ToStringff& .
(ff. /
)ff/ 0
)ff0 1
;ff1 2
throwgg 
;gg 
}hh 
}kk 	
publicrr 
BoletaDePagorr 
obtenerBoletarr )
(rr) *
SqlDataReaderrr* 7
	resultadorr8 A
)rrA B
{ss 	
BoletaDePagott 
boletatt 
=tt  !
newtt" %
BoletaDePagott& 2
(tt2 3
)tt3 4
;tt4 5
boletauu 
.uu 
Contratouu 
=uu 
newuu !
Contratouu" *
(uu* +
)uu+ ,
;uu, -
boletavv 
.vv 
Nominavv 
=vv 
newvv 
Nominavv  &
(vv& '
)vv' (
;vv( )
boletaxx 
.xx 
	Boleta_idxx 
=xx 
	resultadoxx, 5
.xx5 6
	GetStringxx6 ?
(xx? @
$numxx@ A
)xxA B
;xxB C
boletayy 
.yy 
Contratoyy 
.yy 
Contrato_idyy '
=yy( )
	resultadoyy, 5
.yy5 6
	GetStringyy6 ?
(yy? @
$numyy@ A
)yyA B
;yyB C
boletazz 
.zz 
Nominazz 
.zz 
	Nomina_idzz #
=zz$ %
	resultadozz, 5
.zz5 6
	GetStringzz6 ?
(zz? @
$numzz@ A
)zzA B
;zzB C
boleta{{ 
.{{ 
Sueldobasico{{ 
={{  !
double{{, 2
.{{2 3
Parse{{3 8
({{8 9
	resultado{{9 B
.{{B C

GetDecimal{{C M
({{M N
$num{{N O
){{O P
.{{P Q
ToString{{Q Y
({{Y Z
){{Z [
){{[ \
;{{\ ]
boleta|| 
.|| 
Asignacionfamiliar|| %
=||& '
double||, 2
.||2 3
Parse||3 8
(||8 9
	resultado||9 B
.||B C

GetDecimal||C M
(||M N
$num||N O
)||O P
.||P Q
ToString||Q Y
(||Y Z
)||Z [
)||[ \
;||\ ]
boleta}} 
.}} 
Montoporhoraextras}} %
=}}& '
double}}, 2
.}}2 3
Parse}}3 8
(}}8 9
	resultado}}9 B
.}}B C

GetDecimal}}C M
(}}M N
$num}}N O
)}}O P
.}}P Q
ToString}}Q Y
(}}Y Z
)}}Z [
)}}[ \
;}}\ ]
boleta~~ 
.~~ 

Reintegros~~ 
=~~ 
double~~, 2
.~~2 3
Parse~~3 8
(~~8 9
	resultado~~9 B
.~~B C

GetDecimal~~C M
(~~M N
$num~~N O
)~~O P
.~~P Q
ToString~~Q Y
(~~Y Z
)~~Z [
)~~[ \
;~~\ ]
boleta 
. 
	Movilidad 
= 
double, 2
.2 3
Parse3 8
(8 9
	resultado9 B
.B C

GetDecimalC M
(M N
$numN O
)O P
.P Q
ToStringQ Y
(Y Z
)Z [
)[ \
;\ ]
boleta
ÄÄ 
.
ÄÄ 
Otrosingresos
ÄÄ  
=
ÄÄ! "
double
ÄÄ, 2
.
ÄÄ2 3
Parse
ÄÄ3 8
(
ÄÄ8 9
	resultado
ÄÄ9 B
.
ÄÄB C

GetDecimal
ÄÄC M
(
ÄÄM N
$num
ÄÄN O
)
ÄÄO P
.
ÄÄP Q
ToString
ÄÄQ Y
(
ÄÄY Z
)
ÄÄZ [
)
ÄÄ[ \
;
ÄÄ\ ]
boleta
ÅÅ 
.
ÅÅ  
Regimenpensionario
ÅÅ %
=
ÅÅ& '
double
ÅÅ, 2
.
ÅÅ2 3
Parse
ÅÅ3 8
(
ÅÅ8 9
	resultado
ÅÅ9 B
.
ÅÅB C

GetDecimal
ÅÅC M
(
ÅÅM N
$num
ÅÅN O
)
ÅÅO P
.
ÅÅP Q
ToString
ÅÅQ Y
(
ÅÅY Z
)
ÅÅZ [
)
ÅÅ[ \
;
ÅÅ\ ]
boleta
ÇÇ 
.
ÇÇ "
Montoporhorasdefalta
ÇÇ '
=
ÇÇ( )
double
ÇÇ, 2
.
ÇÇ2 3
Parse
ÇÇ3 8
(
ÇÇ8 9
	resultado
ÇÇ9 B
.
ÇÇB C

GetDecimal
ÇÇC M
(
ÇÇM N
$num
ÇÇN P
)
ÇÇP Q
.
ÇÇQ R
ToString
ÇÇR Z
(
ÇÇZ [
)
ÇÇ[ \
)
ÇÇ\ ]
;
ÇÇ] ^
boleta
ÉÉ 
.
ÉÉ 
	Adelantos
ÉÉ 
=
ÉÉ 
double
ÉÉ, 2
.
ÉÉ2 3
Parse
ÉÉ3 8
(
ÉÉ8 9
	resultado
ÉÉ9 B
.
ÉÉB C

GetDecimal
ÉÉC M
(
ÉÉM N
$num
ÉÉN P
)
ÉÉP Q
.
ÉÉQ R
ToString
ÉÉR Z
(
ÉÉZ [
)
ÉÉ[ \
)
ÉÉ\ ]
;
ÉÉ] ^
boleta
ÑÑ 
.
ÑÑ 
Otrosdescuentos
ÑÑ "
=
ÑÑ# $
double
ÑÑ, 2
.
ÑÑ2 3
Parse
ÑÑ3 8
(
ÑÑ8 9
	resultado
ÑÑ9 B
.
ÑÑB C

GetDecimal
ÑÑC M
(
ÑÑM N
$num
ÑÑN P
)
ÑÑP Q
.
ÑÑQ R
ToString
ÑÑR Z
(
ÑÑZ [
)
ÑÑ[ \
)
ÑÑ\ ]
;
ÑÑ] ^
return
ÜÜ 
boleta
ÜÜ 
;
ÜÜ 
}
àà 	
}
ãã 
}åå ˇù
aC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\ContratoSqlServer.cs
	namespace		 	
Capa4_Persistencia		
 
{

 
public 

class 
ContratoSqlServer "
{ 
private 
readonly 
GestorSqlServer (
	gestorSQL) 2
;2 3
public 
ContratoSqlServer  
(  !
)! "
{ 	
	gestorSQL 
= 
GestorSqlServer '
.' (
getInstance( 3
(3 4
)4 5
;5 6
} 	
public 
void 
guardar 
( 
Contrato $
contrato% -
)- .
{ 	
string 
insertarContrato #
=$ %
$str& p
+q r
$str' n
+o p
$str' z
;z {
try 
{ 

SqlCommand 
comando "
=$ %
	gestorSQL& /
./ 0
ObtenerComandoSQL0 A
(A B
insertarContratoB R
)R S
;S T
comando 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 7
,7 8
contrato9 A
.A B
Contrato_idB M
)M N
;N O
comando 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 7
,7 8
contrato9 A
.A B
EmpleadoB J
.J K
Empleado_idK V
)V W
;W X
comando   
.   

Parameters   "
.  " #
AddWithValue  # /
(  / 0
$str  0 9
,  9 :
contrato  ; C
.  C D
Afp  D G
.  G H
Afp_id  H N
)  N O
;  O P
comando!! 
.!! 

Parameters!! "
.!!" #
AddWithValue!!# /
(!!/ 0
$str!!0 8
,!!8 9
contrato!!: B
.!!B C
Fechainicio!!C N
)!!N O
;!!O P
comando"" 
."" 

Parameters"" "
.""" #
AddWithValue""# /
(""/ 0
$str""0 8
,""8 9
contrato"": B
.""B C
Fechafin""C K
)""K L
;""L M
comando## 
.## 

Parameters## "
.##" #
AddWithValue### /
(##/ 0
$str##0 ;
,##; <
contrato##= E
.##E F#
Tieneasignacionfamiliar##F ]
)##] ^
;##^ _
comando$$ 
.$$ 

Parameters$$ "
.$$" #
AddWithValue$$# /
($$/ 0
$str$$0 9
,$$9 :
contrato$$; C
.$$C D
Horasporsemana$$D R
)$$R S
;$$S T
comando%% 
.%% 

Parameters%% "
.%%" #
AddWithValue%%# /
(%%/ 0
$str%%0 8
,%%8 9
decimal%%: A
.%%A B
Parse%%B G
(%%G H
contrato%%I Q
.%%Q R
Pagoporhora%%R ]
.%%] ^
ToString%%^ f
(%%f g
)%%g h
)%%h i
)%%i j
;%%j k
comando&& 
.&& 

Parameters&& "
.&&" #
AddWithValue&&# /
(&&/ 0
$str&&0 9
,&&9 :
contrato&&; C
.&&C D
Puesto&&D J
)&&J K
;&&K L
comando'' 
.'' 

Parameters'' "
.''" #
AddWithValue''# /
(''/ 0
$str''0 7
,''7 8
contrato''9 A
.''A B
	Cancelado''B K
)''K L
;''L M
comando(( 
.(( 
ExecuteNonQuery(( '
(((' (
)((( )
;(() *
}** 
catch++ 
(++ 
	Exception++ 
err++  
)++  !
{,, 
Console.. 
... 
	WriteLine.. !
(..! "
err.." %
...% &
ToString..& .
(... /
)../ 0
)..0 1
;..1 2
throw// 
;// 
}00 
}33 	
public55 
List55 
<55 
Contrato55 
>55 
obtenerContratos55 .
(55. /
)55/ 0
{66 	
List88 
<88 
Contrato88 
>88 
	contratos88 $
=88% &
new88' *
List88+ /
<88/ 0
Contrato880 8
>888 9
(889 :
)88: ;
;88; <
string99 
consultaSQL99 
=99  
$str99! U
;99U V
try:: 
{;; 
SqlDataReader<< 
resultadoSQL<< *
=<<+ ,
	gestorSQL<<- 6
.<<6 7
EjecutarConsulta<<7 G
(<<G H
consultaSQL<<H S
)<<S T
;<<T U
while== 
(== 
resultadoSQL== "
.==" #
Read==# '
(==' (
)==( )
)==) *
{>> 
	contratos?? 
.?? 
Add?? !
(??! "
obtenerContrato??" 1
(??1 2
resultadoSQL??2 >
)??> ?
)??? @
;??@ A
}@@ 
returnBB 
	contratosBB 
;BB  
}CC 
catchDD 
(DD 
	ExceptionDD 
errDD  
)DD  !
{EE 
ConsoleFF 
.FF 
	WriteLineFF !
(FF! "
errFF" %
.FF% &
ToStringFF& .
(FF. /
)FF/ 0
)FF0 1
;FF1 2
throwGG 
;GG 
}HH 
}KK 	
publicMM 
boolMM 

actualizarMM 
(MM 
ContratoMM '
contratoMM( 0
)MM0 1
{NN 	
stringPP 
actualizarContratoPP %
=PP& '
$strPP( {
+PP| }
$str	QQ' î
+
QQï ñ
$strRR' A
;RRA B
tryTT 
{UU 

SqlCommandWW 
comandoWW "
=WW# $
	gestorSQLWW% .
.WW. /
ObtenerComandoSQLWW/ @
(WW@ A
actualizarContratoWWA S
)WWS T
;WWT U
comandoXX 
.XX 

ParametersXX "
.XX" #
AddWithValueXX# /
(XX/ 0
$strXX0 9
,XX9 :
contratoXX; C
.XXC D
AfpXXD G
.XXG H
Afp_idXXH N
)XXN O
;XXO P
comandoYY 
.YY 

ParametersYY "
.YY" #
AddWithValueYY# /
(YY/ 0
$strYY0 ;
,YY; <
contratoYY= E
.YYE F
FechainicioYYF Q
)YYQ R
;YYR S
comandoZZ 
.ZZ 

ParametersZZ "
.ZZ" #
AddWithValueZZ# /
(ZZ/ 0
$strZZ0 ;
,ZZ; <
contratoZZ= E
.ZZE F
FechafinZZF N
)ZZN O
;ZZO P
comando[[ 
.[[ 

Parameters[[ "
.[[" #
AddWithValue[[# /
([[/ 0
$str[[0 ;
,[[; <
contrato[[= E
.[[E F#
Tieneasignacionfamiliar[[F ]
)[[] ^
;[[^ _
comando\\ 
.\\ 

Parameters\\ "
.\\" #
AddWithValue\\# /
(\\/ 0
$str\\0 9
,\\9 :
contrato\\; C
.\\C D
Horasporsemana\\D R
)\\R S
;\\S T
comando]] 
.]] 

Parameters]] "
.]]" #
AddWithValue]]# /
(]]/ 0
$str]]0 8
,]]8 9
decimal]]: A
.]]A B
Parse]]B G
(]]G H
contrato]]H P
.]]P Q
Pagoporhora]]Q \
.]]\ ]
ToString]]] e
(]]e f
)]]f g
)]]g h
)]]h i
;]]i j
comando^^ 
.^^ 

Parameters^^ "
.^^" #
AddWithValue^^# /
(^^/ 0
$str^^0 9
,^^9 :
contrato^^; C
.^^C D
Puesto^^D J
)^^J K
;^^K L
comando__ 
.__ 

Parameters__ "
.__" #
AddWithValue__# /
(__/ 0
$str__0 7
,__7 8
contrato__9 A
.__A B
	Cancelado__B K
)__K L
;__L M
comando`` 
.`` 

Parameters`` "
.``" #
AddWithValue``# /
(``/ 0
$str``0 7
,``7 8
contrato``9 A
.``A B
Contrato_id``B M
)``M N
;``N O
comandoaa 
.aa 
ExecuteNonQueryaa '
(aa' (
)aa( )
;aa) *
returnbb 
truebb 
;bb 
}cc 
catchdd 
(dd 
SqlExceptiondd 
errdd  #
)dd# $
{ee 
Consolegg 
.gg 
	WriteLinegg !
(gg! "
errgg" %
.gg% &
ToStringgg& .
(gg. /
)gg/ 0
)gg0 1
;gg1 2
throwhh 
;hh 
}ii 
}ll 	
publicpp 
Contratopp 
buscarPorIdpp #
(pp# $
stringpp$ *
idpp+ -
)pp- .
{qq 	
stringrr 
consultaSQLrr 
=rr  
$strrr! Q
+rrR S
idrrT V
+rrW X
$strrrY \
;rr\ ]
tryvv 
{ww 
Contratoxx 
contratoxx !
=xx" #
nullxx$ (
;xx( )
SqlDataReaderyy 
resultadoSQLyy *
=yy+ ,
	gestorSQLyy- 6
.yy6 7
EjecutarConsultayy7 G
(yyG H
consultaSQLyyH S
)yyS T
;yyT U
whilezz 
(zz 
resultadoSQLzz #
.zz# $
Readzz$ (
(zz( )
)zz) *
)zz* +
{{{ 
if|| 
(|| 
obtenerContrato|| '
(||' (
resultadoSQL||( 4
)||4 5
.||5 6
EstaVigente||6 A
(||A B
)||B C
)||C D
{}} 
contrato~~  
=~~! "
obtenerContrato~~# 2
(~~2 3
resultadoSQL~~3 ?
)~~? @
;~~@ A
break 
; 
}
ÄÄ 
}
ÇÇ 
return
ÉÉ 
contrato
ÉÉ 
;
ÉÉ  
}
ÖÖ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
err
ÜÜ  
)
ÜÜ  !
{
áá 
Console
àà 
.
àà 
	WriteLine
àà !
(
àà! "
err
àà" %
.
àà% &
ToString
àà& .
(
àà. /
)
àà/ 0
)
àà0 1
;
àà1 2
throw
ââ 
;
ââ 
}
ää 
}
åå 	
public
êê 
List
êê 
<
êê 
Contrato
êê 
>
êê *
buscarContratosPorIdEmpleado
êê :
(
êê: ;
string
êê; A
id
êêB D
)
êêD E
{
ëë 	
string
ìì 
consultaSQL
ìì 
=
ìì  
$str
ìì! Q
+
ììR S
id
ììT V
+
ììW X
$str
ììY \
;
ìì\ ]
try
îî 
{
ïï 
List
ññ 
<
ññ 
Contrato
ññ 
>
ññ 
	contratos
ññ (
=
ññ) *
new
ññ+ .
List
ññ/ 3
<
ññ3 4
Contrato
ññ4 <
>
ññ< =
(
ññ= >
)
ññ> ?
;
ññ? @
SqlDataReader
óó 
resultadoSQL
óó *
=
óó+ ,
	gestorSQL
óó- 6
.
óó6 7
EjecutarConsulta
óó7 G
(
óóG H
consultaSQL
óóH S
)
óóS T
;
óóT U
if
òò 
(
òò 
resultadoSQL
òò  
.
òò  !
Read
òò! %
(
òò% &
)
òò& '
)
òò' (
{
ôô 
	contratos
öö 
.
öö 
Add
öö !
(
öö! "
obtenerContrato
öö" 1
(
öö1 2
resultadoSQL
öö2 >
)
öö> ?
)
öö? @
;
öö@ A
}
õõ 
return
úú 
	contratos
úú  
;
úú  !
}
ùù 
catch
ûû 
(
ûû 
	Exception
ûû 
err
ûû  
)
ûû  !
{
üü 
Console
†† 
.
†† 
	WriteLine
†† !
(
††! "
err
††" %
.
††% &
ToString
††& .
(
††. /
)
††/ 0
)
††0 1
;
††1 2
throw
°° 
;
°° 
}
¢¢ 
}
§§ 	
public
ßß 
Contrato
ßß 0
"buscarContratoVigentePorIdEmpleado
ßß :
(
ßß: ;
string
ßß; A
id
ßßB D
)
ßßD E
{
®® 	
DateTime
´´ 

fechActual
´´ 
=
´´  !
DateTime
´´" *
.
´´* +
Now
´´+ .
;
´´. /
Console
¨¨ 
.
¨¨ 
	WriteLine
¨¨ 
(
¨¨ 
$str
¨¨ 5
+
¨¨6 7

fechActual
¨¨8 B
.
¨¨B C
ToString
¨¨C K
(
¨¨K L
$str
¨¨L X
)
¨¨X Y
)
¨¨Y Z
;
¨¨Z [
string
≠≠ 
consultaSQL
≠≠ 
=
≠≠  
$str
≠≠! Q
+
≠≠R S
id
≠≠T V
+
≠≠W X
$str
≠≠Y m
+
≠≠m n

fechActual
≠≠n x
.
≠≠x y
ToString≠≠y Å
(≠≠Å Ç
$str≠≠Ç é
)≠≠é è
+≠≠ê ë
$str≠≠ë î
;≠≠î ï
Console
ÆÆ 
.
ÆÆ 
	WriteLine
ÆÆ 
(
ÆÆ 
consultaSQL
ÆÆ )
)
ÆÆ) *
;
ÆÆ* +
try
∞∞ 
{
±± 
Contrato
≤≤ 
contrato
≤≤ !
=
≤≤" #
null
≤≤$ (
;
≤≤( )
SqlDataReader
≥≥ 
resultadoSQL
≥≥ *
=
≥≥+ ,
	gestorSQL
≥≥- 6
.
≥≥6 7
EjecutarConsulta
≥≥7 G
(
≥≥G H
consultaSQL
≥≥H S
)
≥≥S T
;
≥≥T U
while
¥¥ 
(
¥¥ 
resultadoSQL
¥¥ "
.
¥¥" #
Read
¥¥# '
(
¥¥' (
)
¥¥( )
)
¥¥) *
{
µµ 
if
∂∂ 
(
∂∂ 
obtenerContrato
∂∂ '
(
∂∂' (
resultadoSQL
∂∂( 4
)
∂∂4 5
.
∂∂5 6
EstaVigente
∂∂6 A
(
∂∂A B
)
∂∂B C
)
∂∂C D
{
∑∑ 
contrato
∏∏  
=
∏∏! "
obtenerContrato
∏∏# 2
(
∏∏2 3
resultadoSQL
∏∏3 ?
)
∏∏? @
;
∏∏@ A
break
ππ 
;
ππ 
}
∫∫ 
}
ºº 
return
ææ 
contrato
ææ 
;
ææ  
}
øø 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
err
¿¿  
)
¿¿  !
{
¡¡ 
Console
¬¬ 
.
¬¬ 
	WriteLine
¬¬ !
(
¬¬! "
err
¬¬" %
.
¬¬% &
ToString
¬¬& .
(
¬¬. /
)
¬¬/ 0
)
¬¬0 1
;
¬¬1 2
throw
√√ 
;
√√ 
}
ƒƒ 
}
∆∆ 	
public
…… 
bool
…… 
cancelar
…… 
(
…… 
string
…… #

idContrato
……$ .
)
……. /
{
   	
try
ÀÀ 
{
ÃÃ 
string
ÕÕ 
consultaSQL
ÕÕ "
=
ÕÕ# $
$str
ÕÕ% c
+
ÕÕd e

idContrato
ÕÕf p
+
ÕÕq r
$str
ÕÕs v
;
ÕÕv w

SqlCommand
–– 
comando
–– "
=
––# $
	gestorSQL
––% .
.
––. /
ObtenerComandoSQL
––/ @
(
––@ A
consultaSQL
––A L
)
––L M
;
––M N
comando
—— 
.
—— 

Parameters
—— "
.
——" #
AddWithValue
——# /
(
——/ 0
$str
——0 8
,
——8 9
true
——: >
)
——> ?
;
——? @
comando
““ 
.
““ 
ExecuteNonQuery
““ '
(
““' (
)
““( )
;
““) *
return
”” 
true
”” 
;
”” 
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
err
’’  
)
’’  !
{
÷÷ 
Console
ÿÿ 
.
ÿÿ 
	WriteLine
ÿÿ !
(
ÿÿ! "
err
ÿÿ" %
.
ÿÿ% &
ToString
ÿÿ& .
(
ÿÿ. /
)
ÿÿ/ 0
)
ÿÿ0 1
;
ÿÿ1 2
throw
ŸŸ 
;
ŸŸ 
}
⁄⁄ 
}
‹‹ 	
public
ﬁﬁ 
Contrato
ﬁﬁ 
obtenerContrato
ﬁﬁ '
(
ﬁﬁ' (
SqlDataReader
ﬁﬁ( 5
	resultado
ﬁﬁ6 ?
)
ﬁﬁ? @
{
ﬂﬂ 	
Contrato
‡‡ 
contrato
‡‡ 
=
‡‡ 
new
‡‡  #
Contrato
‡‡$ ,
(
‡‡, -
)
‡‡- .
;
‡‡. /
Afp
·· 
afp
·· 
=
·· 
new
·· 
Afp
·· 
(
·· 
)
·· 
;
··  
Empleado
‚‚ 
empleado
‚‚ 
=
‚‚ 
new
‚‚  #
Empleado
‚‚$ ,
(
‚‚, -
)
‚‚- .
;
‚‚. /
contrato
‰‰ 
.
‰‰ 
Afp
‰‰ 
=
‰‰ 
afp
‰‰ 
;
‰‰ 
contrato
ÂÂ 
.
ÂÂ 
Empleado
ÂÂ 
=
ÂÂ 
empleado
ÂÂ  (
;
ÂÂ( )
contrato
ÁÁ 
.
ÁÁ 
Contrato_id
ÁÁ  
=
ÁÁ! "
	resultado
ÁÁ# ,
.
ÁÁ, -
	GetString
ÁÁ- 6
(
ÁÁ6 7
$num
ÁÁ7 8
)
ÁÁ8 9
;
ÁÁ9 :
contrato
ËË 
.
ËË 
Empleado
ËË 
.
ËË 
Empleado_id
ËË )
=
ËË* +
	resultado
ËË, 5
.
ËË5 6
	GetString
ËË6 ?
(
ËË? @
$num
ËË@ A
)
ËËA B
;
ËËB C
contrato
ÈÈ 
.
ÈÈ 
Afp
ÈÈ 
.
ÈÈ 
Afp_id
ÈÈ 
=
ÈÈ  !
	resultado
ÈÈ" +
.
ÈÈ+ ,
GetInt32
ÈÈ, 4
(
ÈÈ4 5
$num
ÈÈ5 6
)
ÈÈ6 7
;
ÈÈ7 8
contrato
ÍÍ 
.
ÍÍ 
Fechainicio
ÍÍ  
=
ÍÍ! "
	resultado
ÍÍ# ,
.
ÍÍ, -
GetDateTime
ÍÍ- 8
(
ÍÍ8 9
$num
ÍÍ9 :
)
ÍÍ: ;
;
ÍÍ; <
contrato
ÎÎ 
.
ÎÎ 
Fechafin
ÎÎ 
=
ÎÎ 
	resultado
ÎÎ  )
.
ÎÎ) *
GetDateTime
ÎÎ* 5
(
ÎÎ5 6
$num
ÎÎ6 7
)
ÎÎ7 8
;
ÎÎ8 9
contrato
ÏÏ 
.
ÏÏ %
Tieneasignacionfamiliar
ÏÏ ,
=
ÏÏ- .
	resultado
ÏÏ/ 8
.
ÏÏ8 9

GetBoolean
ÏÏ9 C
(
ÏÏC D
$num
ÏÏD E
)
ÏÏE F
;
ÏÏF G
contrato
ÌÌ 
.
ÌÌ 
Horasporsemana
ÌÌ #
=
ÌÌ$ %
	resultado
ÌÌ& /
.
ÌÌ/ 0
GetInt32
ÌÌ0 8
(
ÌÌ8 9
$num
ÌÌ9 :
)
ÌÌ: ;
;
ÌÌ; <
contrato
ÓÓ 
.
ÓÓ 
Pagoporhora
ÓÓ  
=
ÓÓ! "
Double
ÓÓ$ *
.
ÓÓ* +
Parse
ÓÓ+ 0
(
ÓÓ0 1
	resultado
ÓÓ2 ;
.
ÓÓ; <

GetDecimal
ÓÓ< F
(
ÓÓF G
$num
ÓÓG H
)
ÓÓH I
.
ÓÓI J
ToString
ÓÓJ R
(
ÓÓR S
)
ÓÓS T
)
ÓÓT U
;
ÓÓU V
contrato
ÔÔ 
.
ÔÔ 
Puesto
ÔÔ 
=
ÔÔ 
	resultado
ÔÔ '
.
ÔÔ' (
	GetString
ÔÔ( 1
(
ÔÔ1 2
$num
ÔÔ2 3
)
ÔÔ3 4
;
ÔÔ4 5
contrato
 
.
 
	Cancelado
 
=
  
	resultado
! *
.
* +

GetBoolean
+ 5
(
5 6
$num
6 7
)
7 8
;
8 9
return
ÚÚ 
contrato
ÚÚ 
;
ÚÚ 
}
ÛÛ 	
}
ıı 
}ˆˆ éA
aC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\EmpleadoSqlServer.cs
	namespace		 	
Capa4_Persistencia		
 
{

 
public 

class 
EmpleadoSqlServer "
{ 
private 
readonly 
GestorSqlServer (
	gestorSQL) 2
;2 3
public 
EmpleadoSqlServer  
(  !
)! "
{ 	
	gestorSQL 
= 
GestorSqlServer '
.' (
getInstance( 3
(3 4
)4 5
;5 6
} 	
public 
bool 
guardar 
( 
Empleado $
empleado% -
)- .
{ 	
string 
insertarEmpleado #
=$ %
$str	& â
+
ä ã
$str( ^
;^ _
try 
{ 

SqlCommand 
comando "
=# $
	gestorSQL% .
.. /
ObtenerComandoSQL/ @
(@ A
insertarEmpleadoA Q
)Q R
;R S
comando   
.   

Parameters   "
.  " #
AddWithValue  # /
(  / 0
$str  0 5
,  5 6
$str  6 ;
+  < =
empleado  > F
.  F G
Dni  G J
)  J K
;  K L
comando!! 
.!! 

Parameters!! "
.!!" #
AddWithValue!!# /
(!!/ 0
$str!!0 6
,!!6 7
empleado!!8 @
.!!@ A
Nombres!!A H
)!!H I
;!!I J
comando"" 
."" 

Parameters"" "
.""" #
AddWithValue""# /
(""/ 0
$str""0 6
,""6 7
empleado""8 @
.""@ A
	Apellidos""A J
)""J K
;""K L
comando## 
.## 

Parameters## "
.##" #
AddWithValue### /
(##/ 0
$str##0 6
,##6 7
empleado##8 @
.##@ A
Dni##A D
)##D E
;##E F
comando$$ 
.$$ 

Parameters$$ "
.$$" #
AddWithValue$$# /
($$/ 0
$str$$0 8
,$$8 9
empleado$$: B
.$$B C
Fechanacimiento$$C R
)$$R S
;$$S T
comando%% 
.%% 

Parameters%% "
.%%" #
AddWithValue%%# /
(%%/ 0
$str%%0 7
,%%7 8
empleado%%9 A
.%%A B
Telefono%%B J
)%%J K
;%%K L
comando&& 
.&& 

Parameters&& "
.&&" #
AddWithValue&&# /
(&&/ 0
$str&&0 9
,&&9 :
empleado&&; C
.&&C D
Correo&&D J
)&&J K
;&&K L
comando'' 
.'' 

Parameters'' "
.''" #
AddWithValue''# /
(''/ 0
$str''0 6
,''6 7
empleado''8 @
.''@ A
	Direccion''A J
)''J K
;''K L
comando(( 
.(( 
ExecuteNonQuery(( '
(((' (
)((( )
;(() *
return)) 
true)) 
;)) 
}++ 
catch,, 
(,, 
	Exception,, 
err,,  
),,  !
{-- 
Console// 
.// 
	WriteLine// !
(//! "
err//" %
.//% &
ToString//& .
(//. /
)/// 0
)//0 1
;//1 2
throw00 
;00 
}11 
}22 	
public44 
Empleado44  
buscarEmpleadoPorDni44 ,
(44, -
string44- 3
dni444 7
)447 8
{55 	
Empleado66 
empleado66 
=66 
null66  $
;66$ %
string77 
consultaSQL77 
=77  
$str77! I
+77J K
dni77L O
+77P Q
$str77R U
;77U V
try88 
{99 
SqlDataReader:: 
resultadoSQL:: *
=::+ ,
	gestorSQL::- 6
.::6 7
EjecutarConsulta::7 G
(::G H
consultaSQL::H S
)::S T
;::T U
if;; 
(;; 
resultadoSQL;;  
.;;  !
Read;;! %
(;;% &
);;& '
);;' (
{<< 
empleado== 
=== 
obtenerEmpleado== .
(==. /
resultadoSQL==/ ;
)==; <
;==< =
}>> 
return?? 
empleado?? 
;??  
}@@ 
catchAA 
(AA 
	ExceptionAA 
errAA  
)AA  !
{BB 
ConsoleCC 
.CC 
	WriteLineCC !
(CC! "
errCC" %
.CC% &
ToStringCC& .
(CC. /
)CC/ 0
)CC0 1
;CC1 2
throwDD 
;DD 
}EE 
}GG 	
publicII 
EmpleadoII 
buscarEmpleadoPorIdII +
(II+ ,
stringII, 2
idII3 5
)II5 6
{JJ 	
stringLL 
consultaSQLLL 
=LL  
$strLL! Q
+LLR S
idLLT V
+LLW X
$strLLY \
;LL\ ]
tryMM 
{NN 
SqlDataReaderPP 
resultadoSQLPP *
=PP+ ,
	gestorSQLPP- 6
.PP6 7
EjecutarConsultaPP7 G
(PPG H
consultaSQLPPH S
)PPS T
;PPT U
EmpleadoQQ 
empleadoQQ !
=QQ" #
nullQQ$ (
;QQ( )
ifRR 
(RR 
resultadoSQLRR  
.RR  !
ReadRR! %
(RR% &
)RR& '
)RR' (
{SS 
empleadoTT 
=TT 
obtenerEmpleadoTT .
(TT. /
resultadoSQLTT/ ;
)TT; <
;TT< =
}UU 
returnWW 
empleadoWW 
;WW  
}XX 
catchYY 
(YY 
SqlExceptionYY 
errSqlYY  &
)YY& '
{ZZ 
Console[[ 
.[[ 
	WriteLine[[ !
([[! "
errSql[[" (
.[[( )
Message[[) 0
)[[0 1
;[[1 2
throw\\ 
;\\ 
}]] 
}`` 	
publicbb 
Empleadobb 
obtenerEmpleadobb '
(bb' (
SqlDataReaderbb) 6
	resultadobb7 @
)bb@ A
{cc 	
Empleadodd 
empleadodd 
=dd 
newdd  #
Empleadodd$ ,
(dd, -
)dd- .
;dd. /
empleadoee 
.ee 
Empleado_idee  
=ee! "
	resultadoee# ,
.ee, -
	GetStringee- 6
(ee6 7
$numee7 8
)ee8 9
;ee9 :
empleadoff 
.ff 
Nombresff 
=ff 
	resultadoff (
.ff( )
	GetStringff) 2
(ff2 3
$numff3 4
)ff4 5
;ff5 6
empleadogg 
.gg 
	Apellidosgg 
=gg  
	resultadogg! *
.gg* +
	GetStringgg+ 4
(gg4 5
$numgg5 6
)gg6 7
;gg7 8
empleadohh 
.hh 
Dnihh 
=hh 
	resultadohh $
.hh$ %
	GetStringhh% .
(hh. /
$numhh/ 0
)hh0 1
;hh1 2
empleadoii 
.ii 
Fechanacimientoii $
=ii% &
	resultadoii' 0
.ii0 1
GetDateTimeii1 <
(ii< =
$numii= >
)ii> ?
;ii? @
empleadojj 
.jj 
Telefonojj 
=jj 
	resultadojj  )
.jj) *
	GetStringjj* 3
(jj3 4
$numjj4 5
)jj5 6
;jj6 7
empleadokk 
.kk 
Correokk 
=kk 
	resultadokk '
.kk' (
	GetStringkk( 1
(kk1 2
$numkk2 3
)kk3 4
;kk4 5
empleadoll 
.ll 
	Direccionll 
=ll  
	resultadoll! *
.ll* +
	GetStringll+ 4
(ll4 5
$numll5 6
)ll6 7
;ll7 8
returnnn 
empleadonn 
;nn 
}pp 	
}tt 
}uu äH
_C:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\GestorSqlServer.cs
	namespace		 	
Capa4_Persistencia		
 
{

 
public 

class 
GestorSqlServer  
{ 
private 
SqlConnection 
conexion &
;& '
private 
SqlTransaction 
transaccion *
;* +
private 
static 
GestorSqlServer &
gestorSingleton' 6
;6 7
private 
GestorSqlServer 
(  
)  !
{ 	
} 	
public 
static 
GestorSqlServer %
getInstance& 1
(1 2
)2 3
{ 	
if 
( 
gestorSingleton 
== !
null" &
)& '
{ 
gestorSingleton 
=  !
new# &
GestorSqlServer' 6
(6 7
)7 8
;8 9
} 
return   
gestorSingleton   "
;  " #
}!! 	
public$$ 
void$$ 
AbrirConexion$$ !
($$! "
)$$" #
{%% 	
try&& 
{'' 
conexion(( 
=(( 
new(( 
SqlConnection(( ,
(((, -
)((- .
;((. /
conexion)) 
.)) 
ConnectionString)) )
=))* +
$str)), u
;))u v
conexion** 
.** 
Open** 
(** 
)** 
;**  
Console++ 
.++ 
	WriteLine++ !
(++! "
$str++" 8
)++8 9
;++9 :
},, 
catch-- 
(-- 
	Exception-- 
err--  
)--  !
{.. 
Console// 
.// 
	WriteLine// !
(//! "
err//" %
.//% &
ToString//& .
(//. /
)/// 0
)//0 1
;//1 2
throw00 
;00 
}11 
}33 	
public55 
void55 
CerrarConexion55 "
(55" #
)55# $
{66 	
try77 
{88 
conexion99 
.99 
Close99 
(99 
)99  
;99  !
}:: 
catch;; 
(;; 
	Exception;; 
err;;  
);;  !
{<< 
Console== 
.== 
	WriteLine== !
(==! "
err==" %
.==% &
ToString==& .
(==. /
)==/ 0
)==0 1
;==1 2
throw>> 
;>> 
}?? 
}AA 	
publicCC 
voidCC 
IniciarTransaccionCC &
(CC& '
)CC' (
{DD 	
tryEE 
{FF 
AbrirConexionGG 
(GG 
)GG 
;GG  
transaccionHH 
=HH 
conexionHH &
.HH& '
BeginTransactionHH' 7
(HH7 8
)HH8 9
;HH9 :
}II 
catchJJ 
(JJ 
	ExceptionJJ 
errJJ  
)JJ  !
{KK 
ConsoleLL 
.LL 
	WriteLineLL !
(LL! "
errLL" %
.LL% &
ToStringLL& .
(LL. /
)LL/ 0
)LL0 1
;LL1 2
throwMM 
;MM 
}NN 
}OO 	
publicQQ 
voidQQ 
TerminarTransaccionQQ '
(QQ' (
)QQ( )
{RR 	
trySS 
{TT 
transaccionUU 
.UU 
CommitUU "
(UU" #
)UU# $
;UU$ %
conexionVV 
.VV 
CloseVV 
(VV 
)VV  
;VV  !
}WW 
catchXX 
(XX 
	ExceptionXX 
errXX  
)XX  !
{YY 
ConsoleZZ 
.ZZ 
	WriteLineZZ !
(ZZ! "
errZZ" %
.ZZ% &
ToStringZZ& .
(ZZ. /
)ZZ/ 0
)ZZ0 1
;ZZ1 2
throw[[ 
;[[ 
}\\ 
}]] 	
public__ 
void__ 
CancelarTransaccion__ '
(__' (
)__( )
{`` 	
tryaa 
{bb 
transaccioncc 
.cc 
Rollbackcc $
(cc$ %
)cc% &
;cc& '
conexiondd 
.dd 
Closedd 
(dd 
)dd  
;dd  !
}ee 
catchff 
(ff 
	Exceptionff 
errff  
)ff  !
{gg 
Consolehh 
.hh 
	WriteLinehh !
(hh! "
errhh" %
.hh% &
ToStringhh& .
(hh. /
)hh/ 0
)hh0 1
;hh1 2
throwii 
;ii 
}jj 
}kk 	
publicmm 
SqlDataReadermm 
EjecutarConsultamm -
(mm- .
stringmm. 4
sentenciaSQLmm5 A
)mmA B
{nn 	
tryoo 
{pp 

SqlCommandqq 

comandoSQLqq %
=qq& '
conexionqq( 0
.qq0 1
CreateCommandqq1 >
(qq> ?
)qq? @
;qq@ A
ifrr 
(rr 
transaccionrr 
!=rr  "
nullrr# '
)rr' (

comandoSQLss 
.ss 
Transactionss *
=ss+ ,
transaccionss- 8
;ss8 9

comandoSQLtt 
.tt 
CommandTexttt &
=tt' (
sentenciaSQLtt) 5
;tt5 6

comandoSQLuu 
.uu 
CommandTypeuu &
=uu' (
CommandTypeuu) 4
.uu4 5
Textuu5 9
;uu9 :
returnvv 

comandoSQLvv !
.vv! "
ExecuteReadervv" /
(vv/ 0
)vv0 1
;vv1 2
}ww 
catchxx 
(xx 
	Exceptionxx 
errxx  
)xx  !
{yy 
Consolezz 
.zz 
	WriteLinezz !
(zz! "
errzz" %
.zz% &
ToStringzz& .
(zz. /
)zz/ 0
)zz0 1
;zz1 2
throw{{ 
;{{ 
}|| 
}}} 	
public 

SqlCommand 
ObtenerComandoSQL +
(+ ,
string, 2
sentenciaSQL3 ?
)? @
{
ÄÄ 	
try
ÅÅ 
{
ÇÇ 

SqlCommand
ÉÉ 

comandoSQL
ÉÉ %
=
ÉÉ& '
conexion
ÉÉ( 0
.
ÉÉ0 1
CreateCommand
ÉÉ1 >
(
ÉÉ> ?
)
ÉÉ? @
;
ÉÉ@ A
if
ÑÑ 
(
ÑÑ 
transaccion
ÑÑ 
!=
ÑÑ  "
null
ÑÑ# '
)
ÑÑ' (

comandoSQL
ÖÖ 
.
ÖÖ 
Transaction
ÖÖ *
=
ÖÖ+ ,
transaccion
ÖÖ- 8
;
ÖÖ8 9

comandoSQL
ÜÜ 
.
ÜÜ 
CommandText
ÜÜ &
=
ÜÜ' (
sentenciaSQL
ÜÜ) 5
;
ÜÜ5 6

comandoSQL
áá 
.
áá 
CommandType
áá &
=
áá' (
CommandType
áá) 4
.
áá4 5
Text
áá5 9
;
áá9 :
return
àà 

comandoSQL
àà !
;
àà! "
}
ââ 
catch
ää 
(
ää 
	Exception
ää 
err
ää  
)
ää  !
{
ãã 
Console
åå 
.
åå 
	WriteLine
åå !
(
åå! "
err
åå" %
.
åå% &
ToString
åå& .
(
åå. /
)
åå/ 0
)
åå0 1
;
åå1 2
throw
çç 
;
çç 
}
éé 
}
èè 	
public
ëë 

SqlCommand
ëë +
ObtenerComandoDeProcedimiento
ëë 7
(
ëë7 8
string
ëë8 >%
procedimientoAlmacenado
ëë? V
)
ëëV W
{
íí 	
try
ìì 
{
îî 

SqlCommand
ïï 

comandoSQL
ïï %
=
ïï& '
conexion
ïï( 0
.
ïï0 1
CreateCommand
ïï1 >
(
ïï> ?
)
ïï? @
;
ïï@ A
if
ññ 
(
ññ 
transaccion
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (

comandoSQL
óó 
.
óó 
Transaction
óó *
=
óó+ ,
transaccion
óó- 8
;
óó8 9

comandoSQL
òò 
.
òò 
CommandText
òò &
=
òò' (%
procedimientoAlmacenado
òò) @
;
òò@ A

comandoSQL
ôô 
.
ôô 
CommandType
ôô &
=
ôô' (
CommandType
ôô) 4
.
ôô4 5
StoredProcedure
ôô5 D
;
ôôD E
return
öö 

comandoSQL
öö !
;
öö! "
}
õõ 
catch
úú 
(
úú 
	Exception
úú 
err
úú  
)
úú  !
{
ùù 
Console
ûû 
.
ûû 
	WriteLine
ûû !
(
ûû! "
err
ûû" %
.
ûû% &
ToString
ûû& .
(
ûû. /
)
ûû/ 0
)
ûû0 1
;
ûû1 2
throw
üü 
;
üü 
}
†† 
}
°° 	
}
§§ 
}•• É@
jC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\IncidenciaLaboralSqlServer.cs
	namespace		 	
Capa4_Persistencia		
 
{

 
public 

class &
IncidenciaLaboralSqlServer +
{ 
private 
readonly 
GestorSqlServer (
	gestorSQL) 2
;2 3
public &
IncidenciaLaboralSqlServer )
() *
)* +
{ 	
	gestorSQL 
= 
GestorSqlServer '
.' (
getInstance( 3
(3 4
)4 5
;5 6
} 	
public 
bool 
guardar 
( 
IncidenciaLaboral -

incidencia. 8
)8 9
{ 	
try 
{ 
string 
insertarSql "
=# $
$str	% é
+
è ê
$str% Y
;Y Z

SqlCommand   
comando   "
=  # $
	gestorSQL  % .
.  . /
ObtenerComandoSQL  / @
(  @ A
insertarSql  A L
)  L M
;  M N
comando!! 
.!! 

Parameters!! "
.!!" #
AddWithValue!!# /
(!!/ 0
$str!!0 5
,!!5 6

incidencia!!6 @
.!!@ A
Incidencia_id!!A N
)!!N O
;!!O P
comando"" 
."" 

Parameters"" "
.""" #
AddWithValue""# /
(""/ 0
$str""0 8
,""8 9

incidencia"": D
.""D E
Periodo""E L
.""L M

Periodo_id""M W
)""W X
;""X Y
comando## 
.## 

Parameters## "
.##" #
AddWithValue### /
(##/ 0
$str##0 7
,##7 8

incidencia##9 C
.##C D
Contrato##D L
.##L M
Contrato_id##M X
)##X Y
;##Y Z
comando$$ 
.$$ 

Parameters$$ "
.$$" #
AddWithValue$$# /
($$/ 0
$str$$0 >
,$$> ?

incidencia$$@ J
.$$J K
Totalhorasdefalta$$K \
)$$\ ]
;$$] ^
comando%% 
.%% 

Parameters%% "
.%%" #
AddWithValue%%# /
(%%/ 0
$str%%0 >
,%%> ?

incidencia%%@ J
.%%J K
Totalhorasextras%%K [
)%%[ \
;%%\ ]
comando&& 
.&& 
ExecuteNonQuery&& '
(&&' (
)&&( )
;&&) *
return'' 
true'' 
;'' 
}(( 
catch)) 
()) 
	Exception)) 
err))  
)))  !
{** 
Console,, 
.,, 
	WriteLine,, !
(,,! "
err,," %
.,,% &
ToString,,& .
(,,. /
),,/ 0
),,0 1
;,,1 2
throw-- 
;-- 
}.. 
}00 	
public33 
List33 
<33 
IncidenciaLaboral33 %
>33% &%
obtenerListaPorIdContrato33' @
(33@ A
string33A G
id33H J
)33J K
{44 	
string66 
	buscarSql66 
=66 
$str66 U
+66V W
id66X Z
+66[ \
$str66] `
;66` a
List77 
<77 
IncidenciaLaboral77 "
>77" #
listaIncidencias77$ 4
=775 6
new777 :
List77; ?
<77? @
IncidenciaLaboral77@ Q
>77Q R
(77R S
)77S T
;77T U
try99 
{:: 
SqlDataReader;; 
	resultado;; '
=;;( )
	gestorSQL;;* 3
.;;3 4
EjecutarConsulta;;4 D
(;;D E
	buscarSql;;E N
);;N O
;;;O P
while== 
(== 
	resultado==  
.==  !
Read==! %
(==% &
)==& '
)==' (
{>> 
listaIncidencias?? $
.??$ %
Add??% (
(??( )
obtenerIncidencia??) :
(??: ;
	resultado??; D
)??D E
)??E F
;??F G
}@@ 
returnCC 
listaIncidenciasCC '
;CC' (
}DD 
catchEE 
(EE 
	ExceptionEE 
errEE  
)EE  !
{FF 
ConsoleHH 
.HH 
	WriteLineHH !
(HH! "
errHH" %
.HH% &
ToStringHH& .
(HH. /
)HH/ 0
)HH0 1
;HH1 2
throwII 
;II 
}JJ 
}NN 	
publicUU 
ListUU 
<UU 
IncidenciaLaboralUU %
>UU% &
obtenerPorIdPeriodoUU' :
(UU: ;
stringUU; A
idUUB D
)UUD E
{VV 	
stringWW 
	buscarSqlWW 
=WW 
$strWW T
+WWU V
idWWW Y
+WWZ [
$strWW\ _
;WW_ `
ListXX 
<XX 
IncidenciaLaboralXX "
>XX" #
listaIncidenciasXX$ 4
=XX5 6
newXX7 :
ListXX; ?
<XX? @
IncidenciaLaboralXX@ Q
>XXQ R
(XXR S
)XXS T
;XXT U
tryZZ 
{[[ 
SqlDataReader\\ 
	resultado\\ '
=\\( )
	gestorSQL\\* 3
.\\3 4
EjecutarConsulta\\4 D
(\\D E
	buscarSql\\E N
)\\N O
;\\O P
while^^ 
(^^ 
	resultado^^  
.^^  !
Read^^! %
(^^% &
)^^& '
)^^' (
{__ 
listaIncidencias`` $
.``$ %
Add``% (
(``( )
obtenerIncidencia``) :
(``: ;
	resultado``; D
)``D E
)``E F
;``F G
}aa 
returndd 
listaIncidenciasdd '
;dd' (
}ee 
catchff 
(ff 
	Exceptionff 
errff  
)ff  !
{gg 
Consoleii 
.ii 
	WriteLineii !
(ii! "
errii" %
.ii% &
ToStringii& .
(ii. /
)ii/ 0
)ii0 1
;ii1 2
throwjj 
;jj 
}kk 
}mm 	
privateoo 
IncidenciaLaboraloo !
obtenerIncidenciaoo" 3
(oo3 4
SqlDataReaderoo4 A
	resultadoooB K
)ooK L
{pp 	
IncidenciaLaboralqq 

incidenciaqq (
=qq) *
newqq+ .
IncidenciaLaboralqq/ @
(qq@ A
)qqA B
;qqB C

incidenciarr 
.rr 
Periodorr 
=rr  
newrr! $
PeriodoDeNominarr% 4
(rr4 5
)rr5 6
;rr6 7

incidenciass 
.ss 
Contratoss 
=ss  !
newss" %
Contratoss& .
(ss. /
)ss/ 0
;ss0 1

incidenciauu 
.uu 
Incidencia_iduu $
=uu% &
	resultadouu' 0
.uu0 1
GetInt32uu1 9
(uu9 :
$numuu: ;
)uu; <
;uu< =

incidenciavv 
.vv 
Periodovv 
.vv 

Periodo_idvv )
=vv* +
	resultadovv, 5
.vv5 6
	GetStringvv6 ?
(vv? @
$numvv@ A
)vvA B
;vvB C

incidenciaww 
.ww 
Contratoww 
.ww  
Contrato_idww  +
=ww, -
	resultadoww. 7
.ww7 8
	GetStringww8 A
(wwA B
$numwwB C
)wwC D
;wwD E

incidenciaxx 
.xx 
Totalhorasdefaltaxx (
=xx) *
	resultadoxx+ 4
.xx4 5
GetInt32xx5 =
(xx= >
$numxx> ?
)xx? @
;xx@ A

incidenciayy 
.yy 
Totalhorasextrasyy '
=yy( )
	resultadoyy* 3
.yy3 4
GetInt32yy4 <
(yy< =
$numyy= >
)yy> ?
;yy? @
returnzz 

incidenciazz 
;zz 
}|| 	
}
ÅÅ 
}ÇÇ Î?
_C:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\NominaSqlServer.cs
	namespace		 	
Capa4_Persistencia		
 
{

 
public 

class 
NominaSqlServer  
{ 
private 
readonly 
GestorSqlServer (
	gestorSQL) 2
;2 3
public 
NominaSqlServer 
( 
)  
{ 	
	gestorSQL 
= 
GestorSqlServer '
.' (
getInstance( 3
(3 4
)4 5
;5 6
} 	
public 
bool 
guardar 
( 
Nomina "
nomina# )
)) *
{ 	
string 
insertarNomina !
=" #
$str$ i
+j k
$str$ V
;V W
try 
{ 

SqlCommand 
comando "
=# $
	gestorSQL% .
.. /
ObtenerComandoSQL/ @
(@ A
insertarNominaA O
)O P
;P Q
comando 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 5
,5 6
nomina7 =
.= >
	Nomina_id> G
)G H
;H I
comando   
.   

Parameters   "
.  " #
AddWithValue  # /
(  / 0
$str  0 9
,  9 :
nomina  ; A
.  A B
Periodo  B I
.  I J

Periodo_id  J T
)  T U
;  U V
comando!! 
.!! 

Parameters!! "
.!!" #
AddWithValue!!# /
(!!/ 0
$str!!0 8
,!!8 9
nomina!!: @
.!!@ A
Fecha!!A F
)!!F G
;!!G H
comando"" 
."" 

Parameters"" "
.""" #
AddWithValue""# /
(""/ 0
$str""0 >
,""> ?
nomina""@ F
.""F G
Descripcion""G R
)""R S
;""S T
comando## 
.## 

Parameters## "
.##" #
AddWithValue### /
(##/ 0
$str##0 :
,##: ;
nomina##< B
.##B C
Cerrada##C J
)##J K
;##K L
comando%% 
.%% 
ExecuteNonQuery%% '
(%%' (
)%%( )
;%%) *
return&& 
true&& 
;&& 
}(( 
catch)) 
()) 
	Exception)) 
err))  
)))  !
{** 
Console++ 
.++ 
	WriteLine++ !
(++! "
err++" %
.++% &
Message++& -
)++- .
;++. /
throw,, 
;,, 
}-- 
}// 	
public22 
List22 
<22 
Nomina22 
>22  
buscarPorDescripcion22 0
(220 1
string221 7
descripcion228 C
)22C D
{33 	
string44 
	buscarSql44 
=44 
$str44 O
+44P Q
descripcion44R ]
+44^ _
$str44` d
;44d e
List55 
<55 
Nomina55 
>55 
listaNomina55 $
=55% &
new55' *
List55+ /
<55/ 0
Nomina550 6
>556 7
(557 8
)558 9
;559 :
try77 
{88 
SqlDataReader99 
	resultado99 '
=99( )
	gestorSQL99* 3
.993 4
EjecutarConsulta994 D
(99D E
	buscarSql99E N
)99N O
;99O P
while;; 
(;; 
	resultado;;  
.;;  !
Read;;! %
(;;% &
);;& '
);;' (
{<< 
listaNomina== 
.==  
Add==  #
(==# $
obtenerNomina==$ 1
(==1 2
	resultado==2 ;
)==; <
)==< =
;=== >
}>> 
return@@ 
listaNomina@@ "
;@@" #
}AA 
catchBB 
(BB 
	ExceptionBB 
errBB  
)BB  !
{CC 
ConsoleEE 
.EE 
	WriteLineEE !
(EE! "
errEE" %
.EE% &
ToStringEE& .
(EE. /
)EE/ 0
)EE0 1
;EE1 2
throwFF 
;FF 
}GG 
}HH 	
publicKK 
voidKK 
cerrarKK 
(KK 
NominaKK !
nominaKK" (
)KK( )
{LL 	
tryNN 
{OO 
stringPP 
actualizarrSqlPP %
=PP& '
$strPP( a
+PPb c
nominaPPd j
.PPj k
	Nomina_idPPk t
+PPu v
$strPPw z
;PPz {

SqlCommandRR 
comandoRR "
=RR# $
	gestorSQLRR% .
.RR. /
ObtenerComandoSQLRR/ @
(RR@ A
actualizarrSqlRRA O
)RRO P
;RRP Q
comandoSS 
.SS 
ExecuteNonQuerySS '
(SS' (
)SS( )
;SS) *
}TT 
catchUU 
(UU 
	ExceptionUU 
errUU  
)UU  !
{VV 
ConsoleXX 
.XX 
	WriteLineXX !
(XX! "
errXX" %
.XX% &
ToStringXX& .
(XX. /
)XX/ 0
)XX0 1
;XX1 2
throwYY 
;YY 
}ZZ 
}]] 	
public__ 
void__ 
eliminar__ 
(__ 
Nomina__ #
nomina__$ *
)__* +
{`` 	
tryaa 
{bb 
stringcc 
eliminarSqlcc "
=cc# $
$strcc% N
+ccO P
nominaccQ W
.ccW X
	Nomina_idccX a
+ccb c
$strccd g
;ccg h

SqlCommandee 
comandoee #
=ee$ %
	gestorSQLee& /
.ee/ 0
ObtenerComandoSQLee0 A
(eeA B
eliminarSqleeB M
)eeM N
;eeN O
comandoff 
.ff 
ExecuteNonQueryff '
(ff' (
)ff( )
;ff) *
}gg 
catchhh 
(hh 
	Exceptionhh 
errhh  
)hh  !
{ii 
Consolekk 
.kk 
	WriteLinekk !
(kk! "
errkk" %
.kk% &
ToStringkk& .
(kk. /
)kk/ 0
)kk0 1
;kk1 2
throwll 
;ll 
}mm 
}oo 	
privaterr 
Nominarr 
obtenerNominarr $
(rr$ %
SqlDataReaderrr% 2
	resultadorr3 <
)rr< =
{ss 	
Nominatt 
nominatt 
=tt 
newtt 
Nominatt  &
(tt& '
)tt' (
;tt( )
nominauu 
.uu 
Periodouu 
=uu 
newuu  
PeriodoDeNominauu! 0
(uu0 1
)uu1 2
;uu2 3
nominaww 
.ww 
	Nomina_idww 
=ww 
	resultadoww (
.ww( )
	GetStringww) 2
(ww2 3
$numww3 4
)ww4 5
;ww5 6
nominaxx 
.xx 
Periodoxx 
.xx 

Periodo_idxx %
=xx& '
	resultadoxx( 1
.xx1 2
	GetStringxx2 ;
(xx; <
$numxx< =
)xx= >
;xx> ?
nominayy 
.yy 
Fechayy 
=yy 
	resultadoyy $
.yy$ %
GetDateTimeyy% 0
(yy0 1
$numyy1 2
)yy2 3
;yy3 4
nominazz 
.zz 
Descripcionzz 
=zz  
	resultadozz! *
.zz* +
	GetStringzz+ 4
(zz4 5
$numzz5 6
)zz6 7
;zz7 8
nomina{{ 
.{{ 
Cerrada{{ 
={{ 
	resultado{{ &
.{{& '

GetBoolean{{' 1
({{1 2
$num{{2 3
){{3 4
;{{4 5
return}} 
nomina}} 
;}} 
}~~ 	
}
ÅÅ 
}ÇÇ íE
hC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\PeriodoDeNominaSqlServer.cs
	namespace		 	
Capa4_Persistencia		
 
{

 
public 

class $
PeriodoDeNominaSqlServer )
{ 
private 
readonly 
GestorSqlServer (
	gestorSQL) 2
;2 3
public $
PeriodoDeNominaSqlServer '
(' (
)( )
{ 	
	gestorSQL 
= 
GestorSqlServer '
.' (
getInstance( 3
(3 4
)4 5
;5 6
} 	
public 
bool 
guardar 
( 
PeriodoDeNomina +
periodoDeNomina, ;
); <
{ 	
string 
insertarPeriodo "
=# $
$str% m
+n o
$str( K
;K L
try 
{ 

SqlCommand 
comando "
=# $
	gestorSQL% .
.. /
ObtenerComandoSQL/ @
(@ A
insertarPeriodoA P
)P Q
;Q R
comando 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 5
,5 6
$str7 =
+> ?
periodoDeNomina@ O
.O P

Periodo_idP Z
)Z [
;[ \
comando 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 7
,7 8
periodoDeNomina9 H
.H I
DescripcionI T
)T U
;U V
comando 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 9
,9 :
periodoDeNomina; J
.J K
FechainicioK V
)V W
;W X
comando   
.   

Parameters   "
.  " #
AddWithValue  # /
(  / 0
$str  0 9
,  9 :
periodoDeNomina  ; J
.  J K
Fechafin  K S
)  S T
;  T U
comando!! 
.!! 
ExecuteNonQuery!! '
(!!' (
)!!( )
;!!) *
return"" 
true"" 
;"" 
}$$ 
catch%% 
(%% 
	Exception%% 
err%%  
)%%  !
{&& 
Console(( 
.(( 
	WriteLine(( !
(((! "
err((" %
.((% &
ToString((& .
(((. /
)((/ 0
)((0 1
;((1 2
throw)) 
;)) 
}** 
}++ 	
public-- 
PeriodoDeNomina-- 
buscarPeriodoPorId-- 1
(--1 2
string--2 8
id--9 ;
)--; <
{.. 	
PeriodoDeNomina// 
periodoDeNomina// +
=//, -
null//. 2
;//2 3
string00 
consultaSQL00 
=00  
$str00! U
+00V W
id00X Z
+00[ \
$str00] `
;00` a
try11 
{22 
SqlDataReader33 
resultadoSQL33 *
=33+ ,
	gestorSQL33- 6
.336 7
EjecutarConsulta337 G
(33G H
consultaSQL33H S
)33S T
;33T U
if44 
(44 
resultadoSQL44  
.44  !
Read44! %
(44% &
)44& '
)44' (
{55 
periodoDeNomina66 #
=66$ %"
obtenerPeriodoDeNomina66& <
(66< =
resultadoSQL66= I
)66I J
;66J K
}77 
return88 
periodoDeNomina88 &
;88& '
}99 
catch:: 
(:: 
	Exception:: 
err::  
)::  !
{;; 
Console<< 
.<< 
	WriteLine<< !
(<<! "
err<<" %
.<<% &
ToString<<& .
(<<. /
)<</ 0
)<<0 1
;<<1 2
throw== 
;== 
}>> 
}@@ 	
publicBB 
ListBB 
<BB 
PeriodoDeNominaBB #
>BB# $%
buscarPeriodosPorIdNominaBB% >
(BB> ?
NominaBB? E
nominaBBF L
)BBL M
{CC 	
ListDD 
<DD 
PeriodoDeNominaDD  
>DD  ! 
listaPeriodoDeNominaDD" 6
=DD7 8
newDD9 <
ListDD= A
<DDA B
PeriodoDeNominaDDB Q
>DDQ R
(DDR S
)DDS T
;DDT U
stringFF 
consultaSQLFF 
=FF  
$strFF! U
+FFV W
nominaFFX ^
.FF^ _
PeriodoFF_ f
.FFf g

Periodo_idFFg q
+FFr s
$strFFt w
;FFw x
tryGG 
{HH 
SqlDataReaderII 
resultadoSQLII *
=II+ ,
	gestorSQLII- 6
.II6 7
EjecutarConsultaII7 G
(IIG H
consultaSQLIIH S
)IIS T
;IIT U
whileJJ 
(JJ 
resultadoSQLJJ #
.JJ# $
ReadJJ$ (
(JJ( )
)JJ) *
)JJ* +
{KK 
PeriodoDeNominaLL #
periodoLL$ +
=LL, -"
obtenerPeriodoDeNominaLL. D
(LLD E
resultadoSQLLLE Q
)LLQ R
;LLR S 
listaPeriodoDeNominaMM (
.MM( )
AddMM) ,
(MM, -
periodoMM- 4
)MM4 5
;MM5 6
}NN 
returnPP  
listaPeriodoDeNominaPP +
;PP+ ,
}QQ 
catchRR 
(RR 
	ExceptionRR 
errRR  
)RR  !
{SS 
ConsoleTT 
.TT 
	WriteLineTT !
(TT! "
errTT" %
.TT% &
ToStringTT& .
(TT. /
)TT/ 0
)TT0 1
;TT1 2
throwUU 
;UU 
}VV 
}XX 	
public]] 
PeriodoDeNomina]] "
obtenerPeriodoDeNomina]] 5
(]]5 6
SqlDataReader]]6 C
	resultado]]D M
)]]M N
{^^ 	
PeriodoDeNomina__ 
periodoDeNomina__ +
=__, -
new__. 1
PeriodoDeNomina__2 A
(__A B
)__B C
;__C D
periodoDeNomina`` 
.`` 

Periodo_id`` &
=``' (
	resultado``) 2
.``2 3
	GetString``3 <
(``< =
$num``= >
)``> ?
;``? @
periodoDeNominaaa 
.aa 
Descripcionaa '
=aa( )
	resultadoaa* 3
.aa3 4
	GetStringaa4 =
(aa= >
$numaa> ?
)aa? @
;aa@ A
periodoDeNominabb 
.bb 
Fechainiciobb '
=bb( )
	resultadobb* 3
.bb3 4
GetDateTimebb4 ?
(bb? @
$numbb@ A
)bbA B
;bbB C
periodoDeNominacc 
.cc 
Fechafincc $
=cc% &
	resultadocc' 0
.cc0 1
GetDateTimecc1 <
(cc< =
$numcc= >
)cc> ?
;cc? @
returndd 
periodoDeNominadd "
;dd" #
}ff 	
publichh 
Listhh 
<hh 
PeriodoDeNominahh #
>hh# $
listarPeriodohh% 2
(hh2 3
)hh3 4
{ii 	
Listjj 
<jj 
PeriodoDeNominajj  
>jj  !
listaPeriodojj" .
=jj/ 0
newjj1 4
Listjj5 9
<jj9 :
PeriodoDeNominajj: I
>jjI J
(jjJ K
)jjK L
;jjL M
stringkk 
consultaSQLkk 
=kk  
$strkk! >
;kk> ?
tryll 
{mm 
SqlDataReadernn 
resultadoSQLnn *
=nn+ ,
	gestorSQLnn- 6
.nn6 7
EjecutarConsultann7 G
(nnG H
consultaSQLnnH S
)nnS T
;nnT U
whileoo 
(oo 
resultadoSQLoo #
.oo# $
Readoo$ (
(oo( )
)oo) *
)oo* +
{pp 
listaPeriodoqq  
.qq  !
Addqq! $
(qq$ %"
obtenerPeriodoDeNominaqq% ;
(qq; <
resultadoSQLqq< H
)qqH I
)qqI J
;qqJ K
}rr 
returntt 
listaPeriodott #
;tt# $
}vv 
catchww 
(ww 
SqlExceptionww 
errww  #
)ww# $
{xx 
Consoleyy 
.yy 
	WriteLineyy !
(yy! "
erryy" %
.yy% &
ToStringyy& .
(yy. /
)yy/ 0
)yy0 1
;yy1 2
throwzz 
;zz 
}{{ 
}}} 	
}~~ 
} í
gC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa4_Persistencia\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str -
)- .
]. /
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str /
)/ 0
]0 1
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *