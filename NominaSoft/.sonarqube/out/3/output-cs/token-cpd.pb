§	
qC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Acceso\FormIniciarSesion.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
Acceso& ,
{ 
public 

partial 
class 
FormIniciarSesion *
:+ ,
Form- 1
{ 
public 
FormIniciarSesion  
(  !
)! "
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void "
btnIniciarSesion_Click +
(+ ,
object, 2
sender3 9
,9 :
	EventArgs; D
eE F
)F G
{ 	
FormPrincipal"" 
formPrincipal"" +
="", -
new"". 1
FormPrincipal""2 ?
(""? @
)""@ A
;""A B
formPrincipal## 
.## 
Show## "
(##" #
this### '
)##' (
;##( )
Visible$$ 
=$$ 
false$$ 
;$$  
})) 	
}** 
}++ ä¸
xC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Contratos\FormGestionarContrato.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
	Contratos& /
{ 
public 

partial 
class !
FormGestionarContrato .
:/ 0
Form1 5
{ 
private %
GestionarContratoServicio )
contratoServicio* :
;: ;
private %
GestionarEmpleadoServicio )
empleadoServicio* :
;: ;
private  
GestionarAfpServicio $
afpServicio% 0
;0 1
private 
List 
< 
Afp 
> 
listaAfp "
;" #
private 
Empleado 
empleado !
;! "
private 
Contrato 
contrato !
;! "
public !
FormGestionarContrato $
($ %
)% &
{ 	
InitializeComponent 
(  
)  !
;! "
panelGeneralInfo 
. 
Visible $
=% &
false' ,
;, -
empleadoServicio 
= 
new "%
GestionarEmpleadoServicio# <
(< =
)= >
;> ?
contratoServicio 
= 
new "%
GestionarContratoServicio# <
(< =
)= >
;> ?
afpServicio 
= 
new  
GestionarAfpServicio 2
(2 3
)3 4
;4 5
} 	
private   
void   &
buttonBuscarEmpleado_Click   /
(  / 0
object  0 6
sender  7 =
,  = >
	EventArgs  ? H
e  I J
)  J K
{!! 	
try%% 
{&& 
if(( 
((( 
panelGeneralInfo(( $
.(($ %
Visible((% ,
)((, -
{)) 
panelGeneralInfo** $
.**$ %
Visible**% ,
=**- .
false**/ 4
;**4 5
}++ 
string-- 
dni-- 
=-- 
textBoxDniEmpleado-- /
.--/ 0
Text--0 4
.--4 5
Trim--5 9
(--9 :
)--: ;
;--; <
if// 
(// 
dni// 
.// 
All// 
(// 
char//  
.//  !
IsDigit//! (
)//( )
)//) *
{00 
if11 
(11 
dni11 
.11 
Length11 !
==11" $
$num11% &
)11& '
{22 
Empleado33  
empleadoAux33! ,
=33- .
empleadoServicio33/ ?
.33? @ 
buscarEmpleadoPorDni33@ T
(33T U
dni33U X
)33X Y
;33Y Z
if44 
(44 
empleadoAux44 &
!=44' )
null44* .
)44. /
{55 
this66  
.66  !
empleado66! )
=66* +
empleadoAux66, 7
;667 8
cargarDatosEmpleado77 /
(77/ 0
empleadoAux770 ;
)77; <
;77< =
buttonActualizar88 ,
.88, -
Visible88- 4
=885 6
false887 <
;88< =
panelGeneralInfo99 ,
.99, -
Visible99- 4
=995 6
true997 ;
;99; <
listaAfp:: $
=::% &
afpServicio::' 2
.::2 3
obtenerListaAfp::3 B
(::B C
)::C D
;::D E
};; 
else<< 
{== 

MessageBox>> &
.>>& '
Show>>' +
(>>+ ,
$str>>, U
+>>V W
dni>>X [
)>>[ \
;>>\ ]
}?? 
}AA 
elseBB 
{CC 

MessageBoxDD "
.DD" #
ShowDD# '
(DD' (
$strDD( T
)DDU V
;DDV W
}EE 
}GG 
elseHH 
{II 

MessageBoxJJ 
.JJ 
ShowJJ #
(JJ# $
$strJJ$ R
)JJR S
;JJS T
}KK 
}OO 
catchPP 
(PP 
	ExceptionPP 
errPP  
)PP  !
{QQ 

MessageBoxSS 
.SS 
ShowSS 
(SS  
thisSS  $
,SS$ %
$strSS& 1
+SS2 3
errSS4 7
.SS7 8
MessageSS8 ?
)SS? @
;SS@ A
}TT 
}VV 	
privateXX 
voidXX 
cargarDatosEmpleadoXX (
(XX( )
EmpleadoXX) 1
empleadoXX2 :
)XX: ;
{YY 	
labelIdEmpleado[[ 
.[[ 
Text[[  
=[[! "
empleado[[# +
.[[+ ,
Empleado_id[[, 7
;[[7 8&
labelNombreApellidEmpleado\\ &
.\\& '
Text\\' +
=\\, -
empleado\\. 6
.\\6 7
	Apellidos\\7 @
+\\A B
$str\\C G
+\\H I
empleado\\J R
.\\R S
Nombres\\S Z
;\\Z [
labelCorreoEmpleado]] 
.]]  
Text]]  $
=]]% &
empleado]]' /
.]]/ 0
Correo]]0 6
;]]6 7
labelTelefono^^ 
.^^ 
Text^^ 
=^^  
empleado^^! )
.^^) *
Telefono^^* 2
;^^2 3
labelDirecc__ 
.__ 
Text__ 
=__ 
empleado__ '
.__' (
	Direccion__( 1
;__1 2
labelFechaNac`` 
.`` 
Text`` 
=``  
empleado``! )
.``) *
Fechanacimiento``* 9
.``9 :
ToShortDateString``: K
(``K L
)``L M
;``M N
trybb 
{cc 
thisdd 
.dd 
contratodd 
=dd 
contratoServiciodd  0
.dd0 1.
"buscarContratoVigentePorIdEmpleadodd1 S
(ddS T
empleadoddT \
.dd\ ]
Empleado_iddd] h
)ddh i
;ddi j
ifee 
(ee 
thisee 
.ee 
contratoee  
!=ee! #
nullee$ (
&&ee) +
thisee, 0
.ee0 1
contratoee1 9
.ee9 :
EstaVigenteee: E
(eeE F
)eeF G
)eeG H
{ff &
cargarDatosContratoVigentehh .
(hh. /
thishh/ 3
.hh3 4
contratohh4 <
)hh< =
;hh= >
panelInfoContratoii %
.ii% &
Visibleii& -
=ii. /
trueii0 4
;ii4 5
buttonCrearContratojj '
.jj' (
Enabledjj( /
=jj0 1
falsejj2 7
;jj7 8 
buttonEditarContratokk (
.kk( )
Enabledkk) 0
=kk1 2
truekk3 7
;kk7 8!
buttonGuardarContratoll )
.ll) *
Visiblell* 1
=ll2 3
falsell4 9
;ll9 :!
buttonGuardarContratomm )
.mm) *
Enabledmm* 1
=mm2 3
falsemm4 9
;mm9 :"
buttonCancelarContratonn *
.nn* +
Enablednn+ 2
=nn3 4
truenn5 9
;nn9 :
}qq 
}tt 
catchuu 
(uu 
	Exceptionuu 
erruu  
)uu  !
{vv 

MessageBoxxx 
.xx 
Showxx 
(xx  
thisxx  $
,xx$ %
$strxx& 1
+xx2 3
errxx4 7
.xx7 8
Messagexx8 ?
)xx? @
;xx@ A
buttonCrearContratozz #
.zz# $
Enabledzz$ +
=zz, -
truezz. 2
;zz2 3 
buttonEditarContrato{{ $
.{{$ %
Enabled{{% ,
={{- .
false{{/ 4
;{{4 5
panelInfoContrato|| !
.||! "
Visible||" )
=||* +
false||, 1
;||1 2
}}} 
}
ÅÅ 	
private
ÑÑ 
void
ÑÑ (
cargarDatosContratoVigente
ÑÑ /
(
ÑÑ/ 0
Contrato
ÑÑ0 8
contrato
ÑÑ9 A
)
ÑÑA B
{
ÖÖ 	
labelIdContrato
ââ 
.
ââ 
Text
ââ  
=
ââ! "
$str
ââ# )
+
ââ) *
contrato
ââ+ 3
.
ââ3 4
Contrato_id
ââ4 ?
;
ââ? @
dateTimeInicio
ää 
.
ää 
Value
ää  
=
ää! "
contrato
ää# +
.
ää+ ,
Fechainicio
ää, 7
;
ää7 8
dateTimeFin
ãã 
.
ãã 
Value
ãã 
=
ãã 
contrato
ãã  (
.
ãã( )
Fechafin
ãã) 1
;
ãã1 2
textBoxPuesto
åå 
.
åå 
Text
åå 
=
åå  
contrato
åå! )
.
åå) *
Puesto
åå* 0
;
åå0 1 
textBoxHorasSemana
çç 
.
çç 
Text
çç #
=
çç$ %
contrato
çç& .
.
çç. /
Horasporsemana
çç/ =
.
çç= >
ToString
çç> F
(
ççF G
)
ççG H
;
ççH I
textBoxPagoHora
éé 
.
éé 
Text
éé  
=
éé! "
contrato
éé# +
.
éé+ ,
Pagoporhora
éé, 7
.
éé7 8
ToString
éé8 @
(
éé@ A
)
ééA B
;
ééB C
if
êê 
(
êê 
contrato
êê 
.
êê %
Tieneasignacionfamiliar
êê 0
)
êê0 1
{
ëë 

checkBoxSi
íí 
.
íí 
Checked
íí "
=
íí# $
true
íí% )
;
íí) *
}
ìì 
else
îî 
{
ïï 

checkBoxNo
ññ 
.
ññ 
Checked
ññ "
=
ññ# $
true
ññ% )
;
ññ) *
}
óó 
contrato
ôô 
.
ôô 
Afp
ôô 
=
ôô 
afpServicio
ôô &
.
ôô& '
buscarAfpPorId
ôô' 5
(
ôô5 6
contrato
ôô6 >
.
ôô> ?
Afp
ôô? B
.
ôôB C
Afp_id
ôôC I
)
ôôI J
;
ôôJ K
comboBoxAfp
öö 
.
öö 
Text
öö 
=
öö 
contrato
öö '
.
öö' (
Afp
öö( +
.
öö+ ,
Nombre
öö, 2
;
öö2 3!
desactivarControles
ùù 
(
ùù  
)
ùù  !
;
ùù! "
}
üü 	
private
°° 
void
°° '
buttonCrearContrato_Click
°° .
(
°°. /
object
°°/ 5
sender
°°6 <
,
°°< =
	EventArgs
°°> G
e
°°H I
)
°°I J
{
¢¢ 	
panelInfoContrato
££ 
.
££ 
Visible
££ %
=
££& '
true
££( ,
;
££, -#
buttonGuardarContrato
§§ !
.
§§! "
Visible
§§" )
=
§§* +
true
§§, 0
;
§§0 1#
buttonGuardarContrato
•• !
.
••! "
Enabled
••" )
=
••* +
true
••, 0
;
••0 1
buttonActualizar
¶¶ 
.
¶¶ 
Visible
¶¶ $
=
¶¶% &
false
¶¶' ,
;
¶¶, -
buttonActualizar
ßß 
.
ßß 
Enabled
ßß $
=
ßß% &
false
ßß' ,
;
ßß, -
cargarListaAfp
®® 
(
®® 
)
®® 
;
®® 
limpiarDatos
©© 
(
©© 
)
©© 
;
©© 
activarControles
™™ 
(
™™ 
)
™™ 
;
™™ 
}
´´ 	
private
∞∞ 
void
∞∞ )
buttonGuardarContrato_Click
∞∞ 0
(
∞∞0 1
object
∞∞1 7
sender
∞∞8 >
,
∞∞> ?
	EventArgs
∞∞@ I
e
∞∞J K
)
∞∞K L
{
±± 	
try
µµ 
{
∂∂ 
Contrato
∑∑ 
contratoAux
∑∑ $
=
∑∑% &
new
∑∑' *
Contrato
∑∑+ 3
(
∑∑3 4
)
∑∑4 5
;
∑∑5 6
contrato
∏∏ 
.
∏∏ 
Contrato_id
∏∏ $
=
∏∏% &
$str
∏∏' ,
+
∏∏- .$
GenerarNumeroAleatorio
∏∏/ E
.
∏∏E F$
ObtenerNumeroAleatorio
∏∏F \
(
∏∏\ ]
)
∏∏] ^
;
∏∏^ _
contratoAux
ππ 
.
ππ 
Fechainicio
ππ '
=
ππ( )
dateTimeInicio
ππ* 8
.
ππ8 9
Value
ππ9 >
;
ππ> ?
contratoAux
∫∫ 
.
∫∫ 
Fechafin
∫∫ $
=
∫∫% &
dateTimeFin
∫∫' 2
.
∫∫2 3
Value
∫∫3 8
;
∫∫8 9
contratoAux
ªª 
.
ªª 
Puesto
ªª "
=
ªª# $
textBoxPuesto
ªª% 2
.
ªª2 3
Text
ªª3 7
;
ªª7 8
foreach
ΩΩ 
(
ΩΩ 
Afp
ΩΩ 
item
ΩΩ !
in
ΩΩ" $
listaAfp
ΩΩ% -
)
ΩΩ- .
{
ææ 
if
øø 
(
øø 
comboBoxAfp
øø #
.
øø# $
Text
øø$ (
.
øø( )
Equals
øø) /
(
øø/ 0
item
øø0 4
.
øø4 5
Nombre
øø5 ;
)
øø; <
)
øø< =
{
¿¿ 
contratoAux
¡¡ #
.
¡¡# $
Afp
¡¡$ '
=
¡¡( )
item
¡¡* .
;
¡¡. /
break
¬¬ 
;
¬¬ 
}
√√ 
}
ƒƒ 
if
∆∆ 
(
∆∆ 

checkBoxSi
∆∆ 
.
∆∆ 
Checked
∆∆ &
)
∆∆& '
{
«« 
contratoAux
»» 
.
»»  %
Tieneasignacionfamiliar
»»  7
=
»»8 9
true
»»: >
;
»»> ?
}
…… 
if
   
(
   

checkBoxNo
   
.
   
Checked
   &
)
  & '
{
ÀÀ 
contratoAux
ÃÃ 
.
ÃÃ  %
Tieneasignacionfamiliar
ÃÃ  7
=
ÃÃ8 9
false
ÃÃ: ?
;
ÃÃ? @
}
ÕÕ 
string
œœ 
mensaje
œœ 
;
œœ 
if
–– 
(
–– "
validarCamposEntrada
–– (
(
––( )
out
––) ,
mensaje
––- 4
)
––4 5
)
––5 6
{
—— 
contratoAux
”” 
.
””  
Horasporsemana
””  .
=
””/ 0
int
””1 4
.
””4 5
Parse
””5 :
(
””: ; 
textBoxHorasSemana
””; M
.
””M N
Text
””N R
)
””R S
;
””S T
contratoAux
‘‘ 
.
‘‘  
Pagoporhora
‘‘  +
=
‘‘, -
double
‘‘. 4
.
‘‘4 5
Parse
‘‘5 :
(
‘‘: ;
textBoxPagoHora
‘‘; J
.
‘‘J K
Text
‘‘K O
)
‘‘O P
;
‘‘P Q
contratoAux
’’ 
.
’’  
	Cancelado
’’  )
=
’’* +
false
’’, 1
;
’’1 2
if
‹‹ 
(
‹‹ 
contratoAux
‹‹ #
.
‹‹# $
ValidarContrato
‹‹$ 3
(
‹‹3 4
out
‹‹4 7
mensaje
‹‹8 ?
)
‹‹? @
)
‹‹@ A
{
›› 
contratoAux
ﬂﬂ #
.
ﬂﬂ# $
Empleado
ﬂﬂ$ ,
=
ﬂﬂ- .
this
ﬂﬂ/ 3
.
ﬂﬂ3 4
empleado
ﬂﬂ4 <
;
ﬂﬂ< =
contratoServicio
‡‡ (
.
‡‡( )
guardarContrato
‡‡) 8
(
‡‡8 9
contratoAux
‡‡9 D
)
‡‡D E
;
‡‡E F

MessageBox
‚‚ "
.
‚‚" #
Show
‚‚# '
(
‚‚' (
this
‚‚( ,
,
‚‚, -
$str
‚‚. M
)
‚‚M N
;
‚‚N O
panelGeneralInfo
„„ (
.
„„( )
Visible
„„) 0
=
„„1 2
false
„„3 8
;
„„8 9
this
‰‰ 
.
‰‰ 
contrato
‰‰ %
=
‰‰& '
null
‰‰( ,
;
‰‰, -
this
ÂÂ 
.
ÂÂ 
empleado
ÂÂ %
=
ÂÂ& '
null
ÂÂ( ,
;
ÂÂ, -
}
ÁÁ 
else
ËË 
{
ÈÈ 

MessageBox
ÍÍ "
.
ÍÍ" #
Show
ÍÍ# '
(
ÍÍ' (
this
ÍÍ( ,
,
ÍÍ, -
mensaje
ÍÍ. 5
)
ÍÍ5 6
;
ÍÍ6 7
}
ÎÎ 
}
 
else
ÒÒ 
{
ÚÚ 

MessageBox
ÛÛ 
.
ÛÛ 
Show
ÛÛ #
(
ÛÛ# $
this
ÛÛ$ (
,
ÛÛ( )
mensaje
ÛÛ* 1
)
ÛÛ1 2
;
ÛÛ2 3
}
ÙÙ 
}
˘˘ 
catch
˙˙ 
(
˙˙ 
	Exception
˙˙ 
err
˙˙  
)
˙˙  !
{
˚˚ 

MessageBox
˝˝ 
.
˝˝ 
Show
˝˝ 
(
˝˝  
this
˝˝  $
,
˝˝$ %
$str
˝˝% 0
+
˝˝1 2
err
˝˝3 6
.
˝˝6 7
Message
˝˝7 >
)
˝˝> ?
;
˝˝? @
}
˛˛ 
}
ÄÄ 	
private
ÉÉ 
void
ÉÉ 
cargarListaAfp
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
{
ÑÑ 	
comboBoxAfp
ÜÜ 
.
ÜÜ 
Items
ÜÜ 
.
ÜÜ 
Clear
ÜÜ #
(
ÜÜ# $
)
ÜÜ$ %
;
ÜÜ% &
foreach
áá 
(
áá 
Afp
áá 
item
áá 
in
áá  
listaAfp
áá! )
)
áá) *
{
àà 
comboBoxAfp
ââ 
.
ââ 
Items
ââ !
.
ââ! "
Add
ââ" %
(
ââ% &
item
ââ& *
.
ââ* +
Nombre
ââ+ 1
)
ââ1 2
;
ââ2 3
}
ãã 
}
éé 	
private
êê 
void
êê 
limpiarDatos
êê !
(
êê! "
)
êê" #
{
ëë 	
labelIdContrato
íí 
.
íí 
Text
íí  
=
íí! "
$str
íí# %
;
íí% &
dateTimeInicio
ìì 
.
ìì 
Value
ìì  
=
ìì! "
DateTime
ìì# +
.
ìì+ ,
Now
ìì, /
;
ìì/ 0
dateTimeFin
îî 
.
îî 
Value
îî 
=
îî 
DateTime
îî  (
.
îî( )
Now
îî) ,
;
îî, -
textBoxPuesto
ïï 
.
ïï 
Text
ïï 
=
ïï  
$str
ïï! #
;
ïï# $ 
textBoxHorasSemana
ññ 
.
ññ 
Text
ññ #
=
ññ$ %
$str
ññ& (
;
ññ( )
textBoxPagoHora
óó 
.
óó 
Text
óó  
=
óó! "
$str
óó# %
;
óó% &

checkBoxSi
òò 
.
òò 
Checked
òò 
=
òò  
false
òò! &
;
òò& '

checkBoxNo
ôô 
.
ôô 
Checked
ôô 
=
ôô  
false
ôô! &
;
ôô& '
comboBoxAfp
öö 
.
öö 
Text
öö 
=
öö 
$str
öö +
;
öö+ ,
}
õõ 	
private
ûû 
void
ûû !
desactivarControles
ûû (
(
ûû( )
)
ûû) *
{
üü 	
labelIdContrato
°° 
.
°° 
Enabled
°° #
=
°°$ %
false
°°& +
;
°°+ ,
dateTimeInicio
¢¢ 
.
¢¢ 
Enabled
¢¢ "
=
¢¢# $
false
¢¢% *
;
¢¢* +
dateTimeFin
££ 
.
££ 
Enabled
££ 
=
££  !
false
££" '
;
££' (
textBoxPuesto
§§ 
.
§§ 
Enabled
§§ !
=
§§" #
false
§§$ )
;
§§) * 
textBoxHorasSemana
•• 
.
•• 
Enabled
•• &
=
••' (
false
••) .
;
••. /
textBoxPagoHora
¶¶ 
.
¶¶ 
Enabled
¶¶ #
=
¶¶$ %
false
¶¶& +
;
¶¶+ ,

checkBoxSi
ßß 
.
ßß 
Enabled
ßß 
=
ßß  
false
ßß! &
;
ßß& '

checkBoxNo
®® 
.
®® 
Enabled
®® 
=
®®  
false
®®! &
;
®®& '
comboBoxAfp
©© 
.
©© 
Enabled
©© 
=
©©  !
false
©©" '
;
©©' (
}
™™ 	
private
≠≠ 
void
≠≠ 
activarControles
≠≠ %
(
≠≠% &
)
≠≠& '
{
ÆÆ 	
dateTimeInicio
∞∞ 
.
∞∞ 
Enabled
∞∞ "
=
∞∞# $
true
∞∞% )
;
∞∞) *
dateTimeFin
±± 
.
±± 
Enabled
±± 
=
±±  !
true
±±" &
;
±±& '
textBoxPuesto
≤≤ 
.
≤≤ 
Enabled
≤≤ !
=
≤≤" #
true
≤≤$ (
;
≤≤( ) 
textBoxHorasSemana
≥≥ 
.
≥≥ 
Enabled
≥≥ &
=
≥≥' (
true
≥≥) -
;
≥≥- .
textBoxPagoHora
¥¥ 
.
¥¥ 
Enabled
¥¥ #
=
¥¥$ %
true
¥¥& *
;
¥¥* +

checkBoxSi
µµ 
.
µµ 
Enabled
µµ 
=
µµ  
true
µµ! %
;
µµ% &

checkBoxNo
∂∂ 
.
∂∂ 
Enabled
∂∂ 
=
∂∂  
true
∂∂! %
;
∂∂% &
comboBoxAfp
∑∑ 
.
∑∑ 
Enabled
∑∑ 
=
∑∑  !
true
∑∑" &
;
∑∑& '
}
∏∏ 	
private
∫∫ 
void
∫∫ '
checkBoxSi_CheckedChanged
∫∫ .
(
∫∫. /
object
∫∫/ 5
sender
∫∫6 <
,
∫∫< =
	EventArgs
∫∫> G
e
∫∫H I
)
∫∫I J
{
ªª 	

checkBoxNo
ºº 
.
ºº 
Checked
ºº 
=
ºº  
false
ºº! &
;
ºº& '
}
ΩΩ 	
private
øø 
void
øø '
checkBoxNo_CheckedChanged
øø .
(
øø. /
object
øø/ 5
sender
øø6 <
,
øø< =
	EventArgs
øø> G
e
øøH I
)
øøI J
{
¿¿ 	

checkBoxSi
¡¡ 
.
¡¡ 
Checked
¡¡ 
=
¡¡  
false
¡¡! &
;
¡¡& '
}
¬¬ 	
private
ƒƒ 
void
ƒƒ *
buttonCancelarContrato_Click
ƒƒ 1
(
ƒƒ1 2
object
ƒƒ2 8
sender
ƒƒ9 ?
,
ƒƒ? @
	EventArgs
ƒƒA J
e
ƒƒK L
)
ƒƒL M
{
≈≈ 	
try
∆∆ 
{
«« 
if
»» 
(
»» 
contrato
»» 
!=
»» 
null
»»  $
)
»»$ %
{
…… 
contratoServicio
   $
.
  $ %
cancelarContrato
  % 5
(
  5 6
this
  6 :
.
  : ;
contrato
  ; C
.
  C D
Contrato_id
  D O
)
  O P
;
  P Q
limpiarDatos
ÀÀ  
(
ÀÀ  !
)
ÀÀ! "
;
ÀÀ" #$
buttonCancelarContrato
ÃÃ *
.
ÃÃ* +
Enabled
ÃÃ+ 2
=
ÃÃ3 4
false
ÃÃ5 :
;
ÃÃ: ;#
buttonGuardarContrato
ÕÕ )
.
ÕÕ) *
Visible
ÕÕ* 1
=
ÕÕ2 3
false
ÕÕ4 9
;
ÕÕ9 :

MessageBox
ŒŒ 
.
ŒŒ 
Show
ŒŒ #
(
ŒŒ# $
this
ŒŒ$ (
,
ŒŒ( )
$str
ŒŒ* V
)
ŒŒV W
;
ŒŒW X
panelInfoContrato
œœ %
.
œœ% &
Visible
œœ& -
=
œœ. /
false
œœ0 5
;
œœ5 6!
buttonCrearContrato
–– '
.
––' (
Enabled
––( /
=
––0 1
true
––2 6
;
––6 7"
buttonEditarContrato
—— (
.
——( )
Enabled
——) 0
=
——1 2
false
——3 8
;
——8 9
}
““ 
}
◊◊ 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
err
ÿÿ  
)
ÿÿ  !
{
ŸŸ 

MessageBox
⁄⁄ 
.
⁄⁄ 
Show
⁄⁄ 
(
⁄⁄  
$str
⁄⁄  ,
+
⁄⁄- .
err
⁄⁄/ 2
.
⁄⁄2 3
Message
⁄⁄3 :
)
⁄⁄: ;
;
⁄⁄; <
}
‹‹ 
}
‡‡ 	
private
‚‚ 
void
‚‚ (
buttonEditarContrato_Click
‚‚ /
(
‚‚/ 0
object
‚‚0 6
sender
‚‚7 =
,
‚‚= >
	EventArgs
‚‚? H
e
‚‚I J
)
‚‚J K
{
„„ 	
activarControles
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
cargarListaAfp
ÂÂ 
(
ÂÂ 
)
ÂÂ 
;
ÂÂ 
buttonActualizar
ÊÊ 
.
ÊÊ 
Enabled
ÊÊ $
=
ÊÊ% &
true
ÊÊ' +
;
ÊÊ+ ,
buttonActualizar
ÁÁ 
.
ÁÁ 
Visible
ÁÁ $
=
ÁÁ% &
true
ÁÁ' +
;
ÁÁ+ ,
}
ÈÈ 	
private
ÎÎ 
void
ÎÎ $
buttonActualizar_Click
ÎÎ +
(
ÎÎ+ ,
object
ÎÎ, 2
sender
ÎÎ3 9
,
ÎÎ9 :
	EventArgs
ÎÎ; D
e
ÎÎE F
)
ÎÎF G
{
ÏÏ 	
try
ÓÓ 
{
ÔÔ 
Contrato
 
contratoAux
 $
=
% &
this
' +
.
+ ,
contrato
, 4
;
4 5
contratoAux
ÒÒ 
.
ÒÒ 
Fechainicio
ÒÒ '
=
ÒÒ( )
dateTimeInicio
ÒÒ* 8
.
ÒÒ8 9
Value
ÒÒ9 >
;
ÒÒ> ?
contratoAux
ÚÚ 
.
ÚÚ 
Fechafin
ÚÚ $
=
ÚÚ% &
dateTimeFin
ÚÚ' 2
.
ÚÚ2 3
Value
ÚÚ3 8
;
ÚÚ8 9
contratoAux
ÛÛ 
.
ÛÛ 
Puesto
ÛÛ "
=
ÛÛ# $
textBoxPuesto
ÛÛ% 2
.
ÛÛ2 3
Text
ÛÛ3 7
;
ÛÛ7 8
foreach
ıı 
(
ıı 
Afp
ıı 
item
ıı !
in
ıı" $
listaAfp
ıı% -
)
ıı- .
{
ˆˆ 
if
˜˜ 
(
˜˜ 
comboBoxAfp
˜˜ #
.
˜˜# $
Text
˜˜$ (
.
˜˜( )
Equals
˜˜) /
(
˜˜/ 0
item
˜˜0 4
.
˜˜4 5
Nombre
˜˜5 ;
)
˜˜; <
)
˜˜< =
{
¯¯ 
contratoAux
˘˘ #
.
˘˘# $
Afp
˘˘$ '
=
˘˘( )
item
˘˘* .
;
˘˘. /
break
˙˙ 
;
˙˙ 
}
˚˚ 
}
¸¸ 
if
˛˛ 
(
˛˛ 

checkBoxSi
˛˛ 
.
˛˛ 
Checked
˛˛ &
)
˛˛& '
{
ˇˇ 
contratoAux
ÄÄ 
.
ÄÄ  %
Tieneasignacionfamiliar
ÄÄ  7
=
ÄÄ8 9
true
ÄÄ: >
;
ÄÄ> ?
}
ÅÅ 
if
ÇÇ 
(
ÇÇ 

checkBoxNo
ÇÇ 
.
ÇÇ 
Checked
ÇÇ &
)
ÇÇ& '
{
ÉÉ 
contratoAux
ÑÑ 
.
ÑÑ  %
Tieneasignacionfamiliar
ÑÑ  7
=
ÑÑ8 9
false
ÑÑ: ?
;
ÑÑ? @
}
ÖÖ 
string
àà 
mensaje
àà 
;
àà 
if
ââ 
(
ââ "
validarCamposEntrada
ââ (
(
ââ( )
out
ââ) ,
mensaje
ââ- 4
)
ââ4 5
)
ââ5 6
{
ää 
contratoAux
åå 
.
åå  
Horasporsemana
åå  .
=
åå/ 0
int
åå1 4
.
åå4 5
Parse
åå5 :
(
åå: ; 
textBoxHorasSemana
åå; M
.
ååM N
Text
ååN R
)
ååR S
;
ååS T
contratoAux
çç 
.
çç  
Pagoporhora
çç  +
=
çç, -
double
çç. 4
.
çç4 5
Parse
çç5 :
(
çç: ;
textBoxPagoHora
çç; J
.
ççJ K
Text
ççK O
)
ççO P
;
ççP Q
contratoAux
éé 
.
éé  
	Cancelado
éé  )
=
éé* +
false
éé, 1
;
éé1 2
if
ëë 
(
ëë 
contratoAux
ëë "
.
ëë" #
ValidarContrato
ëë# 2
(
ëë2 3
out
ëë3 6
mensaje
ëë7 >
)
ëë> ?
)
ëë? @
{
íí 
contratoServicio
îî (
.
îî( ) 
actualizarContrato
îî) ;
(
îî; <
contratoAux
îî< G
)
îîG H
;
îîH I

MessageBox
ïï "
.
ïï" #
Show
ïï# '
(
ïï' (
this
ïï( ,
,
ïï, -
$str
ïï. X
)
ïïX Y
;
ïïY Z
panelGeneralInfo
ññ (
.
ññ( )
Visible
ññ) 0
=
ññ1 2
false
ññ3 8
;
ññ8 9
this
óó 
.
óó 
contrato
óó %
=
óó& '
null
óó( ,
;
óó, -
this
òò 
.
òò 
empleado
òò %
=
òò& '
null
òò( ,
;
òò, -
limpiarDatos
ôô $
(
ôô$ %
)
ôô% &
;
ôô& '
buttonActualizar
öö (
.
öö( )
Enabled
öö) 0
=
öö1 2
false
öö3 8
;
öö8 9
}
úú 
else
ùù 
{
ûû 

MessageBox
üü "
.
üü" #
Show
üü# '
(
üü' (
this
üü( ,
,
üü, -
mensaje
üü. 5
)
üü5 6
;
üü6 7
}
†† 
}
¢¢ 
else
££ 
{
§§ 

MessageBox
•• 
.
•• 
Show
•• #
(
••# $
this
••$ (
,
••( )
mensaje
••* 1
)
••1 2
;
••2 3
}
¶¶ 
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ 
err
´´  
)
´´  !
{
¨¨ 

MessageBox
ÆÆ 
.
ÆÆ 
Show
ÆÆ 
(
ÆÆ  
this
ÆÆ  $
,
ÆÆ$ %
$str
ÆÆ& 1
+
ÆÆ2 3
err
ÆÆ4 7
.
ÆÆ7 8
Message
ÆÆ8 ?
)
ÆÆ? @
;
ÆÆ@ A
}
ØØ 
}
∞∞ 	
private
≤≤ 
bool
≤≤ "
validarCamposEntrada
≤≤ )
(
≤≤) *
out
≤≤* -
String
≤≤. 4
mensaje
≤≤5 <
)
≤≤< =
{
≥≥ 	
bool
¥¥ 
validar
¥¥ 
=
¥¥ 
true
¥¥ 
;
¥¥  
mensaje
µµ 
=
µµ 
$str
µµ 9
;
µµ9 :
int
∂∂ 
numeroHoras
∂∂ 
=
∂∂ 
$num
∂∂ 
;
∂∂  
if
∑∑ 
(
∑∑ 
!
∑∑ 
int
∑∑ 
.
∑∑ 
TryParse
∑∑ 
(
∑∑  
textBoxHorasSemana
∑∑ 0
.
∑∑0 1
Text
∑∑1 5
,
∑∑5 6
out
∑∑6 9
numeroHoras
∑∑: E
)
∑∑E F
)
∑∑F G
{
∏∏ 
validar
ππ 
=
ππ 
false
ππ 
;
ππ  
mensaje
∫∫ 
+=
∫∫ 
$str
∫∫ W
;
∫∫W X
}
ªª 
if
ΩΩ 
(
ΩΩ 
!
ΩΩ 

checkBoxSi
ΩΩ 
.
ΩΩ 
Checked
ΩΩ #
&&
ΩΩ$ &
!
ΩΩ' (

checkBoxNo
ΩΩ( 2
.
ΩΩ2 3
Checked
ΩΩ3 :
)
ΩΩ: ;
{
ææ 
validar
øø 
=
øø 
false
øø 
;
øø  
mensaje
¿¿ 
+=
¿¿ 
$str
¿¿ V
;
¿¿V W
}
¡¡ 
double
≈≈ 
numeroPagoHora
≈≈ !
=
≈≈" #
$num
≈≈$ %
;
≈≈% &
if
∆∆ 
(
∆∆ 
!
∆∆ 
double
∆∆ 
.
∆∆ 
TryParse
∆∆  
(
∆∆  !
textBoxPagoHora
∆∆! 0
.
∆∆0 1
Text
∆∆1 5
,
∆∆5 6
out
∆∆6 9
numeroPagoHora
∆∆: H
)
∆∆H I
)
∆∆I J
{
«« 
validar
»» 
=
»» 
false
»» 
;
»» 
mensaje
…… 
+=
…… 
$str
…… K
;
……K L
}
   
if
ÃÃ 
(
ÃÃ 
textBoxPuesto
ÃÃ 
.
ÃÃ 
Text
ÃÃ !
.
ÃÃ! "
Trim
ÃÃ" &
(
ÃÃ& '
)
ÃÃ' (
.
ÃÃ( )
Length
ÃÃ) /
<
ÃÃ0 1
$num
ÃÃ2 3
)
ÃÃ3 4
{
ÕÕ 
validar
ŒŒ 
=
ŒŒ 
false
ŒŒ 
;
ŒŒ 
mensaje
œœ 
+=
œœ 
$str
œœ M
;
œœM N
}
–– 
return
”” 
validar
”” 
;
”” 
}
’’ 	
}
÷÷ 
}◊◊ ˇ
mC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Acceso\FormPrincipal.cs
	namespace		 	
Capa1_Presentacion		
 
.		 
WinForms		 %
.		% &
Acceso		& ,
{

 
public 

partial 
class 
FormPrincipal &
:' (
Form) -
{ 
public 
FormPrincipal 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void  
buttonEmpleado_Click )
() *
object* 0
sender1 7
,7 8
System9 ?
.? @
	EventArgs@ I
eJ K
)K L
{ 	!
FormRegistrarEmpleado !
form" &
=' (
new) ,!
FormRegistrarEmpleado- B
(B C
)C D
;D E
form 
. 

ShowDialog 
( 
) 
; 
} 	
private 
void  
buttonContrato_Click )
() *
object* 0
sender1 7
,7 8
System9 ?
.? @
	EventArgs@ I
eJ K
)K L
{ 	#
FormRegistrarIncidencia #
form$ (
=) *
new+ .#
FormRegistrarIncidencia/ F
(F G
)G H
;H I
form 
. 
Show 
( 
) 
; 
} 	
private!! 
void!! 
buttonNomina_Click!! '
(!!' (
object!!( .
sender!!/ 5
,!!5 6
System!!7 =
.!!= >
	EventArgs!!> G
e!!H I
)!!I J
{"" 	(
FormRegistrarPeriodoDeNomina## (
form##* .
=##/ 0
new##1 4(
FormRegistrarPeriodoDeNomina##5 Q
(##Q R
)##R S
;##S T
form$$ 
.$$ 
Show$$ 
($$ 
)$$ 
;$$ 
}&& 	
private(( 
void(( 
buttonAfp_Click(( $
((($ %
object((% +
sender((, 2
,((2 3
System((4 :
.((: ;
	EventArgs((; D
e((E F
)((F G
{)) 	
FormAFPPrincipal** 
formAFPPrincipal** -
=**. /
new**0 3
FormAFPPrincipal**4 D
(**D E
)**E F
;**F G
formAFPPrincipal++ 
.++ 
Show++ !
(++! "
)++" #
;++# $
},, 	
private.. 
void.. )
buttonGestionarContrato_Click.. 2
(..2 3
object..3 9
sender..: @
,..@ A
System..B H
...H I
	EventArgs..I R
e..S T
)..T U
{// 	!
FormGestionarContrato00 !
formGestionar00" /
=000 1
new002 5!
FormGestionarContrato006 K
(00K L
)00L M
;00M N
formGestionar11 
.11 
Show11 
(11 
this11 #
)11# $
;11$ %
}22 	
private44 
void44 &
buttonProcesarNomina_Click44 /
(44/ 0
object440 6
sender447 =
,44= >
System44? E
.44E F
	EventArgs44F O
e44P Q
)44Q R
{55 	
FormProcesarNomina66 
formProcesar66 +
=66, -
new66. 1
FormProcesarNomina662 D
(66D E
)66E F
;66F G
formProcesar77 
.77 
Show77 
(77 
this77 "
)77" #
;77# $
}88 	
}99 
}:: ’
xC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Empleados\FormRegistrarEmpleado.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
	Empleados& /
{ 
public 

partial 
class !
FormRegistrarEmpleado .
:/ 0
Form1 5
{ 
private %
GestionarEmpleadoServicio )
empleadoServicio* :
;: ;
public !
FormRegistrarEmpleado $
($ %
)% &
{ 	
InitializeComponent 
(  
)  !
;! "
empleadoServicio 
= 
new "%
GestionarEmpleadoServicio# <
(< =
)= >
;> ?
} 	
private 
void '
buttonGuardarEmpleado_Click 0
(0 1
object1 7
sender8 >
,> ?
	EventArgs@ I
eJ K
)K L
{ 	
Empleado 
empleado 
= 
new  #
Empleado$ ,
(, -
)- .
;. /
empleado 
. 
Nombres 
= 
textBoxNombres -
.- .
Text. 2
;2 3
empleado 
. 
	Apellidos 
=  
textBoxApellidos! 1
.1 2
Text2 6
;6 7
empleado 
. 
Dni 
= 

textBoxDni %
.% &
Text& *
.* +
Trim+ /
(/ 0
)0 1
;1 2
empleado 
. 
Fechanacimiento $
=% &
dateTimeNacimiento' 9
.9 :
Value: ?
;? @
empleado 
. 
Telefono 
= 
textBoxTelefono  /
./ 0
Text0 4
.4 5
Trim5 9
(9 :
): ;
;; <
empleado   
.   
Correo   
=   
textBoxCorreo   +
.  + ,
Text  , 0
;  0 1
empleado!! 
.!! 
	Direccion!! 
=!!  
textBoxDireccion!!! 1
.!!1 2
Text!!2 6
;!!6 7
try## 
{$$ 
empleadoServicio%%  
.%%  !
guardarEmpleado%%! 0
(%%0 1
empleado%%1 9
)%%9 :
;%%: ;

MessageBox&& 
.&& 
Show&& 
(&&  
this&&  $
,&&$ %
$str&&& H
)&&H I
;&&I J
this'' 
.'' 
Dispose'' 
('' 
)'' 
;'' 
}(( 
catch)) 
()) 
	Exception)) 
err))  
)))  !
{** 

MessageBox,, 
.,, 
Show,, 
(,,  
this,,  $
,,,$ %
$str,,& /
+,,0 1
err,,2 5
.,,5 6
Message,,6 =
),,= >
;,,> ?
}-- 
}11 	
private33 
void33  
buttonCancelar_Click33 )
(33) *
object33* 0
sender331 7
,337 8
	EventArgs339 B
e33C D
)33D E
{44 	
this55 
.55 
Dispose55 
(55 
)55 
;55 
}66 	
}77 
}88 ˆ1
qC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Nominas\FormBuscarNomina.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
Nominas& -
{ 
public 

partial 
class 
FormBuscarNomina )
:* +
Form, 0
{ 
private 
readonly "
ProcesarNominaServicio /"
procesarNominaServicio0 F
;F G
public 
FormBuscarNomina 
(  
)  !
{ 	"
procesarNominaServicio "
=# $
new% ("
ProcesarNominaServicio) ?
(? @
)@ A
;A B
InitializeComponent 
(  
)  !
;! "
} 	
public 
Nomina 
Nomina 
{ 
get "
;" #
set$ '
;' (
}) *
private 
List 
< 
Nomina 
> 
ListaNominas )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
private 
void 
buttonBuscar_Click '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{   	
try!! 
{"" 
ListaNominas## 
=## 
new## "
List### '
<##' (
Nomina##( .
>##. /
(##/ 0
)##0 1
;##1 2
string&& 
descripcionBusqueda&& *
=&&+ ,$
textBoxDescripcionNomina&&- E
.&&E F
Text&&F J
;&&J K
ListaNominas'' 
='' "
procesarNominaServicio'' 5
.''5 6&
buscarNominaPorDescripcion''6 P
(''P Q
descripcionBusqueda''Q d
)''d e
;''e f$
dataGridViewListaNominas)) (
.))( )
Rows))) -
.))- .
Clear)). 3
())3 4
)))4 5
;))5 6
if** 
(** 
ListaNominas**  
.**  !
Count**! &
>**' (
$num**) *
)*** +
{++ $
dataGridViewListaNominas,, ,
.,,, -
Rows,,- 1
.,,1 2
Add,,2 5
(,,5 6
ListaNominas,,6 B
.,,B C
Count,,C H
),,H I
;,,I J
int-- 
rowEscribir-- #
=--$ %
$num--& '
;--' (
foreach.. 
(.. 
Nomina.. #

nominaItem..$ .
in../ 1
ListaNominas..2 >
)..> ?
{// $
dataGridViewListaNominas11 0
.110 1
Rows111 5
[115 6
rowEscribir116 A
]11A B
.11B C
Cells11C H
[11H I
$num11I J
]11J K
.11K L
Value11L Q
=11R S

nominaItem11T ^
.11^ _
	Nomina_id11_ h
;11h i$
dataGridViewListaNominas22 0
.220 1
Rows221 5
[225 6
rowEscribir226 A
]22A B
.22B C
Cells22C H
[22H I
$num22I J
]22J K
.22K L
Value22L Q
=22R S

nominaItem22T ^
.22^ _
Descripcion22_ j
;22j k$
dataGridViewListaNominas33 0
.330 1
Rows331 5
[335 6
rowEscribir336 A
]33A B
.33B C
Cells33C H
[33H I
$num33I J
]33J K
.33K L
Value33L Q
=33R S

nominaItem33T ^
.33^ _
Fecha33_ d
;33d e
rowEscribir44 #
++44# %
;44% &
}55 
}66 
else77 
{88 

MessageBox99 
.99 
Show99 #
(99# $
$str99$ O
+99P Q
descripcionBusqueda99R e
)99e f
;99f g
}:: 
}== 
catch>> 
(>> 
	Exception>> 
err>>  
)>>  !
{?? 

MessageBoxAA 
.AA 
ShowAA 
(AA  
errAA  #
.AA# $
MessageAA$ +
)AA+ ,
;AA, -
}BB 
}CC 	
privateGG 
voidGG .
"dataGridViewListaNominas_CellClickGG 7
(GG7 8
objectGG8 >
senderGG? E
,GGE F%
DataGridViewCellEventArgsGGG `
eGGa b
)GGb c
{HH 	
tryII 
{JJ 
stringKK 
	nomina_idKK  
=KK! "
(KK# $
stringKK$ *
)KK* +$
dataGridViewListaNominasKK, D
.KKD E

CurrentRowKKE O
.KKO P
CellsKKP U
[KKU V
$numKKV W
]KKW X
.KKX Y
ValueKKY ^
;KK^ _
ifMM 
(MM 
ListaNominasMM 
!=MM  "
nullMM# '
)MM' (
{NN 
foreachOO 
(OO 
NominaOO #

nominaItemOO$ .
inOO/ 1
ListaNominasOO2 >
)OO> ?
{PP 
ifQQ 
(QQ 

nominaItemQQ &
.QQ& '
	Nomina_idQQ' 0
.QQ0 1
EqualsQQ1 7
(QQ7 8
	nomina_idQQ8 A
)QQA B
)QQB C
{RR 
NominaSS "
=SS# $

nominaItemSS% /
;SS/ 0
breakTT !
;TT! "
}UU 
}VV 
ifXX 
(XX 
NominaXX 
!=XX !
nullXX" &
)XX& '
{YY 
thisZZ 
.ZZ 
DialogResultZZ )
=ZZ* +
DialogResultZZ, 8
.ZZ8 9
OKZZ9 ;
;ZZ; <
}[[ 
else\\ 
{]] 
this^^ 
.^^ 
DialogResult^^ )
=^^* +
DialogResult^^, 8
.^^8 9
Cancel^^9 ?
;^^? @
}__ 
}`` 
}cc 
catchdd 
(dd 
	Exceptiondd 
errdd  
)dd  !
{ee 

MessageBoxgg 
.gg 
Showgg 
(gg  
errgg  #
.gg# $
Messagegg$ +
)gg+ ,
;gg, -
}hh 
}ll 	
}mm 
}nn ˇõ
sC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Nominas\FormProcesarNomina.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
Nominas& -
{ 
public 

partial 
class 
FormProcesarNomina +
:, -
Form. 2
{ 
private 
readonly *
GestionarPeriodoNominaServicio 7
periodoServicio8 G
;G H
private 
readonly %
GestionarContratoServicio 2
contratoServicio3 C
;C D
private 
readonly "
ProcesarNominaServicio /"
procesarNominaServicio0 F
;F G
private 
Nomina 
Nomina 
{ 
get  #
;# $
set% (
;( )
}* +
private 
List 
< 
PeriodoDeNomina $
>$ %
ListaPeriodo& 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
private 
List 
< 
Contrato 
> 
ListaContratos -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
public"" 
FormProcesarNomina"" !
(""! "
)""" #
{## 	
InitializeComponent$$ 
($$  
)$$  !
;$$! "
periodoServicio%% 
=%% 
new%% !*
GestionarPeriodoNominaServicio%%" @
(%%@ A
)%%A B
;%%B C
contratoServicio'' 
='' 
new'' "%
GestionarContratoServicio''# <
(''< =
)''= >
;''> ?"
procesarNominaServicio)) "
=))# $
new))% ("
ProcesarNominaServicio))) ?
())? @
)))@ A
;))A B!
panelSeleccionPeriodo++ !
.++! "
Visible++" )
=++* +
false++, 1
;++1 2"
panelInformacionNomina,, "
.,," #
Visible,,# *
=,,+ ,
false,,- 2
;,,2 3"
flowLayoutPanelPeriodo-- "
.--" #
Visible--# *
=--+ ,
false--- 2
;--2 3+
dateTimePickerFechaInicioNomina.. +
...+ ,
Enabled.., 3
=..4 5
false..6 ;
;..; <"
dateTimePickerFechaFin// "
.//" #
Enabled//# *
=//+ ,
false//- 2
;//2 3%
dateTimePickerFechaInicio00 %
.00% &
Enabled00& -
=00. /
false000 5
;005 6
buttonCerrar11 
.11 
Enabled11  
=11! "
false11# (
;11( )
buttonEliminar22 
.22 
Enabled22 "
=22# $
false22% *
;22* +
buttonGuardar33 
.33 
Enabled33 !
=33" #
false33$ )
;33) *
buttonCancelar44 
.44 
Enabled44 "
=44# $
false44% *
;44* +
}66 	
private88 
void88 
cargarListaPeriodo88 '
(88' (
)88( )
{99 	
try:: 
{;; 
ListaPeriodo<< 
=<< 
periodoServicio<< .
.<<. /
obtenerListaPeriodo<</ B
(<<B C
)<<C D
;<<D E
}== 
catch?? 
(?? 
	Exception?? 
err??  
)??  !
{@@ 

MessageBoxBB 
.BB 
ShowBB 
(BB  
$strBB  ,
+BB- .
errBB/ 2
.BB2 3
MessageBB3 :
)BB: ;
;BB; <
}CC 
ifEE 
(EE 
ListaPeriodoEE 
.EE 
CountEE "
>EE# $
$numEE% &
)EE& '
{FF  
comboBoxListaPeriodoGG $
.GG$ %
ItemsGG% *
.GG* +
ClearGG+ 0
(GG0 1
)GG1 2
;GG2 3
foreachHH 
(HH 
PeriodoDeNominaHH (
itemHH) -
inHH. 0
ListaPeriodoHH1 =
)HH= >
{II  
comboBoxListaPeriodoJJ (
.JJ( )
ItemsJJ) .
.JJ. /
AddJJ/ 2
(JJ2 3
itemJJ3 7
.JJ7 8
DescripcionJJ8 C
)JJC D
;JJD E
}KK  
comboBoxListaPeriodoLL $
.LL$ %
TextLL% )
=LL* +
ListaPeriodoLL, 8
[LL8 9
$numLL9 :
]LL: ;
.LL; <
DescripcionLL< G
;LLG H
}MM 
elseNN 
{OO 

MessageBoxPP 
.PP 
ShowPP 
(PP  
$strPP  =
)PP= >
;PP> ?
}QQ 
}TT 	
privateYY 
voidYY $
buttonBuscarNomina_ClickYY -
(YY- .
objectYY. 4
senderYY5 ;
,YY; <
	EventArgsYY= F
eYYG H
)YYH I
{ZZ 	
Nomina\\ 
=\\ 
null\\ 
;\\ 
FormBuscarNomina]] 

formBuscar]] '
=]]( )
new]]* -
FormBuscarNomina]]. >
(]]> ?
)]]? @
;]]@ A
if`` 
(`` 

formBuscar`` 
.`` 

ShowDialog`` %
(``% &
)``& '
==``( *
DialogResult``+ 7
.``7 8
OK``8 :
)``: ;
{aa 
Nominabb 
=bb 

formBuscarbb #
.bb# $
Nominabb$ *
;bb* +
cargarListaPeriodocc "
(cc" #
)cc# $
;cc$ % 
comboBoxListaPeriododd $
.dd$ %
Textdd% )
=dd* +
Nominadd, 2
.dd2 3
Periododd3 :
.dd: ;
Descripciondd; F
.ddF G
ToStringddG O
(ddO P
)ddP Q
;ddQ R
generarPagosBoletaee "
(ee" #
)ee# $
;ee$ %!
panelSeleccionPeriodohh %
.hh% &
Visiblehh& -
=hh. /
truehh0 4
;hh4 5"
panelInformacionNominaii &
.ii& '
Visibleii' .
=ii/ 0
trueii1 5
;ii5 6
buttonCerrarjj 
.jj 
Visiblejj $
=jj% &
truejj' +
;jj+ ,
buttonEliminarkk 
.kk 
Visiblekk &
=kk' (
truekk) -
;kk- .
buttonCerrarll 
.ll 
Enabledll $
=ll% &
truell' +
;ll+ ,
buttonEliminarmm 
.mm 
Enabledmm &
=mm' (
truemm) -
;mm- .
buttonGenerarNominapp #
.pp# $
Enabledpp$ +
=pp, -
falsepp. 3
;pp3 4
buttonGuardarqq 
.qq 
Enabledqq %
=qq& '
falseqq( -
;qq- .
buttonCancelarrr 
.rr 
Enabledrr &
=rr' (
falserr) .
;rr. /
buttonCrearNominass !
.ss! "
Enabledss" )
=ss* +
falsess, 1
;ss1 2
buttonBuscarNominatt "
.tt" #
Enabledtt# *
=tt+ ,
falsett- 2
;tt2 3!
textBoxTotalGeneradosvv %
.vv% &
Enabledvv& -
=vv. /
falsevv0 5
;vv5 6 
textBoxTotalIngresosww $
.ww$ %
Enabledww% ,
=ww- .
falseww/ 4
;ww4 5#
textBoxTotalRetencionesxx '
.xx' (
Enabledxx( /
=xx0 1
falsexx2 7
;xx7 8!
textBoxTotalNetoPagaryy %
.yy% &
Enabledyy& -
=yy. /
falseyy0 5
;yy5 6$
textBoxDescripcionNominazz (
.zz( )
Enabledzz) 0
=zz1 2
falsezz3 8
;zz8 9"
dataGridViewListaPagos{{ &
.{{& '
Enabled{{' .
={{/ 0
false{{1 6
;{{6 7 
comboBoxListaPeriodo|| $
.||$ %
Enabled||% ,
=||- .
false||/ 4
;||4 5
}~~ 
}
ÑÑ 	
private
ÜÜ 
void
ÜÜ %
buttonCrearNomina_Click
ÜÜ ,
(
ÜÜ, -
object
ÜÜ- 3
sender
ÜÜ4 :
,
ÜÜ: ;
	EventArgs
ÜÜ< E
e
ÜÜF G
)
ÜÜG H
{
áá 	
try
ââ 
{
ää  
cargarListaPeriodo
ãã "
(
ãã" #
)
ãã# $
;
ãã$ %#
panelSeleccionPeriodo
éé %
.
éé% &
Visible
éé& -
=
éé. /
true
éé0 4
;
éé4 5$
panelInformacionNomina
èè &
.
èè& '
Visible
èè' .
=
èè/ 0
true
èè1 5
;
èè5 6
buttonCerrar
êê 
.
êê 
Enabled
êê $
=
êê% &
false
êê' ,
;
êê, -
buttonEliminar
ëë 
.
ëë 
Enabled
ëë &
=
ëë' (
false
ëë) .
;
ëë. /!
buttonGenerarNomina
îî #
.
îî# $
Enabled
îî$ +
=
îî, -
true
îî. 2
;
îî2 3
buttonGuardar
ïï 
.
ïï 
Enabled
ïï %
=
ïï& '
true
ïï( ,
;
ïï, -
buttonCancelar
ññ 
.
ññ 
Enabled
ññ &
=
ññ' (
true
ññ) -
;
ññ- .
buttonCrearNomina
óó !
.
óó! "
Enabled
óó" )
=
óó* +
false
óó, 1
;
óó1 2 
buttonBuscarNomina
òò "
.
òò" #
Enabled
òò# *
=
òò+ ,
false
òò- 2
;
òò2 3#
textBoxTotalGenerados
öö %
.
öö% &
Enabled
öö& -
=
öö. /
false
öö0 5
;
öö5 6"
textBoxTotalIngresos
õõ $
.
õõ$ %
Enabled
õõ% ,
=
õõ- .
false
õõ/ 4
;
õõ4 5%
textBoxTotalRetenciones
úú '
.
úú' (
Enabled
úú( /
=
úú0 1
false
úú2 7
;
úú7 8#
textBoxTotalNetoPagar
ùù %
.
ùù% &
Enabled
ùù& -
=
ùù. /
false
ùù0 5
;
ùù5 6&
textBoxDescripcionNomina
ûû (
.
ûû( )
Enabled
ûû) 0
=
ûû1 2
true
ûû3 7
;
ûû7 8$
dataGridViewListaPagos
üü &
.
üü& '
Enabled
üü' .
=
üü/ 0
false
üü1 6
;
üü6 7"
comboBoxListaPeriodo
†† $
.
††$ %
Enabled
††% ,
=
††- .
true
††/ 3
;
††3 4
}
§§ 
catch
•• 
(
•• 
	Exception
•• 
err
••  
)
••  !
{
¶¶ 

MessageBox
®® 
.
®® 
Show
®® 
(
®®  
err
®®  #
.
®®# $
Message
®®$ +
)
®®+ ,
;
®®, -
}
©© 
}
´´ 	
private
ØØ 
void
ØØ "
buttonCancelar_Click
ØØ )
(
ØØ) *
object
ØØ* 0
sender
ØØ1 7
,
ØØ7 8
	EventArgs
ØØ9 B
e
ØØC D
)
ØØD E
{
∞∞ 	
this
±± 
.
±± 
Dispose
±± 
(
±± 
)
±± 
;
±± 
}
≤≤ 	
private
¥¥ 
void
¥¥ 7
)comboBoxListaPeriodo_SelectedIndexChanged
¥¥ >
(
¥¥> ?
object
¥¥? E
sender
¥¥F L
,
¥¥L M
	EventArgs
¥¥N W
e
¥¥X Y
)
¥¥Y Z
{
µµ 	
if
∏∏ 
(
∏∏ 
buscarPeriodo
∏∏ 
(
∏∏ 
)
∏∏ 
!=
∏∏ !
null
∏∏" &
)
∏∏& '
{
ππ 
PeriodoDeNomina
∫∫ 
periodo
∫∫  '
=
∫∫( )
buscarPeriodo
∫∫* 7
(
∫∫7 8
)
∫∫8 9
;
∫∫9 :$
flowLayoutPanelPeriodo
ªª &
.
ªª& '
Visible
ªª' .
=
ªª/ 0
true
ªª1 5
;
ªª5 6
labelIdPeriodo
ºº 
.
ºº 
Text
ºº #
=
ºº$ %
periodo
ºº& -
.
ºº- .

Periodo_id
ºº. 8
;
ºº8 9'
dateTimePickerFechaInicio
ΩΩ )
.
ΩΩ) *
Value
ΩΩ* /
=
ΩΩ0 1
periodo
ΩΩ2 9
.
ΩΩ9 :
Fechainicio
ΩΩ: E
;
ΩΩE F$
dateTimePickerFechaFin
ææ &
.
ææ& '
Value
ææ' ,
=
ææ- .
periodo
ææ/ 6
.
ææ6 7
Fechafin
ææ7 ?
;
ææ? @
}
øø 
else
¿¿ 
{
¡¡ 

MessageBox
¬¬ 
.
¬¬ 
Show
¬¬ 
(
¬¬  
$str
¬¬  A
)
¬¬A B
;
¬¬B C
}
√√ 
}
≈≈ 	
private
…… 
PeriodoDeNomina
…… 
buscarPeriodo
……  -
(
……- .
)
……. /
{
   	
PeriodoDeNomina
ÃÃ 
periodo
ÃÃ  '
=
ÃÃ( )
null
ÃÃ* .
;
ÃÃ. /
foreach
ÕÕ 
(
ÕÕ 
PeriodoDeNomina
ÕÕ (
item
ÕÕ) -
in
ÕÕ. 0
ListaPeriodo
ÕÕ1 =
)
ÕÕ= >
{
ŒŒ 
if
œœ 
(
œœ 
item
œœ 
.
œœ 
Descripcion
œœ (
.
œœ( )
Equals
œœ) /
(
œœ/ 0"
comboBoxListaPeriodo
œœ0 D
.
œœD E
Text
œœE I
)
œœI J
)
œœJ K
{
–– 
periodo
—— 
=
——  !
item
——" &
;
——& '
break
”” 
;
”” 
}
‘‘ 
}
’’ 
return
◊◊ 
periodo
◊◊ 
;
◊◊ 
}
ÿÿ 	
private
⁄⁄ 
void
⁄⁄ '
buttonGenerarNomina_Click
⁄⁄ .
(
⁄⁄. /
object
⁄⁄/ 5
sender
⁄⁄6 <
,
⁄⁄< =
	EventArgs
⁄⁄> G
e
⁄⁄H I
)
⁄⁄I J
{
€€ 	
Nomina
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ 
Nomina
ﬁﬁ #
(
ﬁﬁ# $
)
ﬁﬁ$ %
;
ﬁﬁ% &
generarNomina
ﬂﬂ 
(
ﬂﬂ 
)
ﬂﬂ 
;
ﬂﬂ  
}
·· 	
private
„„ 
void
„„ !
buttonGuardar_Click
„„ (
(
„„( )
object
„„) /
sender
„„0 6
,
„„6 7
	EventArgs
„„8 A
e
„„B C
)
„„C D
{
‰‰ 	
try
ÂÂ 
{
ÊÊ 
Nomina
ËË 
.
ËË 
	Nomina_id
ËË  
=
ËË! "
$str
ËË# (
+
ËË) *$
GenerarNumeroAleatorio
ËË+ A
.
ËËA B$
ObtenerNumeroAleatorio
ËËB X
(
ËËX Y
)
ËËY Z
;
ËËZ [
Nomina
ÈÈ 
.
ÈÈ 
Fecha
ÈÈ 
=
ÈÈ 
DateTime
ÈÈ '
.
ÈÈ' (
Now
ÈÈ( +
;
ÈÈ+ ,
if
ÏÏ 
(
ÏÏ &
textBoxDescripcionNomina
ÏÏ +
.
ÏÏ+ ,
Text
ÏÏ, 0
.
ÏÏ0 1
Trim
ÏÏ1 5
(
ÏÏ5 6
)
ÏÏ6 7
.
ÏÏ7 8
Length
ÏÏ8 >
>
ÏÏ? @
$num
ÏÏA B
)
ÏÏB C
{
ÌÌ 
string
ÓÓ 
mensaje
ÓÓ "
;
ÓÓ" #
if
ÔÔ 
(
ÔÔ 
Nomina
ÔÔ 
.
ÔÔ 
ValidarNomina
ÔÔ ,
(
ÔÔ, -
out
ÔÔ- 0
mensaje
ÔÔ1 8
)
ÔÔ8 9
)
ÔÔ9 :
{
 
Nomina
ÒÒ 
.
ÒÒ 
Descripcion
ÒÒ *
=
ÒÒ+ ,&
textBoxDescripcionNomina
ÒÒ- E
.
ÒÒE F
Text
ÒÒF J
.
ÒÒJ K
ToUpper
ÒÒK R
(
ÒÒR S
)
ÒÒS T
;
ÒÒT U
Nomina
ÚÚ 
.
ÚÚ 
Cerrada
ÚÚ &
=
ÚÚ' (
false
ÚÚ) .
;
ÚÚ. /$
procesarNominaServicio
ˆˆ .
.
ˆˆ. /
guardar
ˆˆ/ 6
(
ˆˆ6 7
Nomina
ˆˆ7 =
)
ˆˆ= >
;
ˆˆ> ?

MessageBox
˜˜ "
.
˜˜" #
Show
˜˜# '
(
˜˜' (
$str
˜˜( =
)
˜˜= >
;
˜˜> ?!
buttonGenerarNomina
˘˘ +
.
˘˘+ ,
Enabled
˘˘, 3
=
˘˘4 5
false
˘˘6 ;
;
˘˘; <
buttonGuardar
˙˙ %
.
˙˙% &
Enabled
˙˙& -
=
˙˙. /
false
˙˙0 5
;
˙˙5 6
buttonCancelar
˚˚ &
.
˚˚& '
Enabled
˚˚' .
=
˚˚/ 0
false
˚˚1 6
;
˚˚6 7
buttonCrearNomina
¸¸ )
.
¸¸) *
Enabled
¸¸* 1
=
¸¸2 3
true
¸¸4 8
;
¸¸8 9 
buttonBuscarNomina
˝˝ *
.
˝˝* +
Enabled
˝˝+ 2
=
˝˝3 4
true
˝˝5 9
;
˝˝9 :#
panelSeleccionPeriodo
ˇˇ -
.
ˇˇ- .
Visible
ˇˇ. 5
=
ˇˇ6 7
false
ˇˇ8 =
;
ˇˇ= >$
panelInformacionNomina
ÄÄ .
.
ÄÄ. /
Visible
ÄÄ/ 6
=
ÄÄ7 8
false
ÄÄ9 >
;
ÄÄ> ? 
limpiarDatosNomina
ÇÇ *
(
ÇÇ* +
)
ÇÇ+ ,
;
ÇÇ, -
}
ÉÉ 
else
ÑÑ 
{
ÖÖ 

MessageBox
ÜÜ "
.
ÜÜ" #
Show
ÜÜ# '
(
ÜÜ' (
mensaje
ÜÜ( /
)
ÜÜ/ 0
;
ÜÜ0 1
}
áá 
}
ââ 
else
ââ 
{
ää 

MessageBox
ãã 
.
ãã 
Show
ãã #
(
ãã# $
$str
ãã$ [
)
ãã[ \
;
ãã\ ]
}
åå 
}
ëë 
catch
íí 
(
íí 
	Exception
íí 
err
íí  
)
íí  !
{
ìì 

MessageBox
ïï 
.
ïï 
Show
ïï 
(
ïï  
err
ïï  #
.
ïï# $
Message
ïï$ +
)
ïï+ ,
;
ïï, -
}
ññ 
}
óó 	
private
úú 
void
úú 
generarNomina
úú "
(
úú" #
)
úú# $
{
ùù 	
try
†† 
{
°° 
ListaContratos
¢¢ 
=
¢¢  
contratoServicio
¢¢! 1
.
¢¢1 2
obtenerContratos
¢¢2 B
(
¢¢B C
)
¢¢C D
;
¢¢D E
if
§§ 
(
§§ 
ListaContratos
§§ "
.
§§" #
Count
§§# (
>
§§) *
$num
§§+ ,
)
§§, -
{
•• 
List
®® 
<
®® 
Contrato
®® !
>
®®! "$
listaContratosFiltrada
®®# 9
=
®®: ; 
ContratosFiltrados
®®< N
(
®®N O
)
®®O P
;
®®P Q
if
´´ 
(
´´ $
listaContratosFiltrada
´´ .
.
´´. /
Count
´´/ 4
>
´´5 6
$num
´´7 8
)
´´8 9
{
¨¨ 
Nomina
ÆÆ 
.
ÆÆ 
BoletaDePagos
ÆÆ ,
=
ÆÆ- .
CrearBoletas
ÆÆ/ ;
(
ÆÆ; <$
listaContratosFiltrada
ÆÆ< R
)
ÆÆR S
;
ÆÆS T
Nomina
ØØ 
.
ØØ 
Periodo
ØØ &
=
ØØ' (
buscarPeriodo
ØØ) 6
(
ØØ6 7
)
ØØ7 8
;
ØØ8 9 
generarPagosBoleta
±± *
(
±±* +
)
±±+ ,
;
±±, -
}
≥≥ 
else
¥¥ 
{
µµ 

MessageBox
∑∑ "
.
∑∑" #
Show
∑∑# '
(
∑∑' (
$str
∑∑( \
)
∑∑\ ]
;
∑∑] ^
}
∏∏ 
}
ªª 
else
ºº 
{
ΩΩ 

MessageBox
ææ 
.
ææ 
Show
ææ #
(
ææ# $
$str
ææ$ X
)
ææX Y
;
ææY Z
}
øø 
}
¡¡ 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
err
¬¬  
)
¬¬  !
{
√√ 

MessageBox
≈≈ 
.
≈≈ 
Show
≈≈ 
(
≈≈  
$str
≈≈  1
+
≈≈2 3
err
≈≈4 7
.
≈≈7 8
Message
≈≈8 ?
)
≈≈? @
;
≈≈@ A
}
∆∆ 
}
   	
private
ÕÕ 
List
ÕÕ 
<
ÕÕ 
Contrato
ÕÕ 
>
ÕÕ  
ContratosFiltrados
ÕÕ 1
(
ÕÕ1 2
)
ÕÕ2 3
{
ŒŒ 	
List
œœ 
<
œœ 
Contrato
œœ 
>
œœ $
listaContratosFiltrada
œœ 1
=
œœ2 3
new
œœ4 7
List
œœ8 <
<
œœ< =
Contrato
œœ= E
>
œœE F
(
œœF G
)
œœG H
;
œœH I
List
–– 
<
–– 
IncidenciaLaboral
–– "
>
––" #&
listaIncidenciasFiltrada
––$ <
;
––< =
foreach
““ 
(
““ 
Contrato
““ 
contrato
““ &
in
““' )
ListaContratos
““* 8
)
““8 9
{
”” &
listaIncidenciasFiltrada
‘‘ (
=
‘‘) *
new
‘‘+ .
List
‘‘/ 3
<
‘‘3 4
IncidenciaLaboral
‘‘4 E
>
‘‘E F
(
‘‘F G
)
‘‘G H
;
‘‘H I
foreach
’’ 
(
’’ 
IncidenciaLaboral
’’ *

incidencia
’’+ 5
in
’’6 8
contrato
’’9 A
.
’’A B
Incidencias
’’B M
)
’’M N
{
÷÷ 
if
ÿÿ 
(
ÿÿ 
buscarPeriodo
ÿÿ %
(
ÿÿ% &
)
ÿÿ& '
!=
ÿÿ( *
null
ÿÿ+ /
&&
ÿÿ0 2

incidencia
ÿÿ3 =
.
ÿÿ= >
Periodo
ÿÿ> E
.
ÿÿE F

Periodo_id
ÿÿF P
.
ÿÿP Q
Equals
ÿÿQ W
(
ÿÿW X
buscarPeriodo
ÿÿX e
(
ÿÿe f
)
ÿÿf g
.
ÿÿg h

Periodo_id
ÿÿh r
)
ÿÿr s
)
ÿÿs t
{
ŸŸ &
listaIncidenciasFiltrada
⁄⁄ 0
.
⁄⁄0 1
Add
⁄⁄1 4
(
⁄⁄4 5

incidencia
⁄⁄5 ?
)
⁄⁄? @
;
⁄⁄@ A
}
€€ 
}
‹‹ 
if
ﬁﬁ 
(
ﬁﬁ &
listaIncidenciasFiltrada
ﬁﬁ ,
.
ﬁﬁ, -
Count
ﬁﬁ- 2
>
ﬁﬁ3 4
$num
ﬁﬁ5 6
)
ﬁﬁ6 7
{
ﬂﬂ 
contrato
‡‡ 
.
‡‡ 
Incidencias
‡‡ (
=
‡‡) *&
listaIncidenciasFiltrada
‡‡+ C
;
‡‡C D$
listaContratosFiltrada
·· *
.
··* +
Add
··+ .
(
··. /
contrato
··/ 7
)
··7 8
;
··8 9
}
‚‚ 
}
„„ 
return
ÂÂ $
listaContratosFiltrada
ÂÂ )
;
ÂÂ) *
}
ÊÊ 	
private
ÍÍ 
List
ÍÍ 
<
ÍÍ 
BoletaDePago
ÍÍ !
>
ÍÍ! "
CrearBoletas
ÍÍ# /
(
ÍÍ/ 0
List
ÍÍ0 4
<
ÍÍ4 5
Contrato
ÍÍ5 =
>
ÍÍ= >$
listaContratosFiltrada
ÍÍ? U
)
ÍÍU V
{
ÎÎ 	
List
ÏÏ 
<
ÏÏ 
BoletaDePago
ÏÏ 
>
ÏÏ 
boletas
ÏÏ &
=
ÏÏ' (
new
ÏÏ) ,
List
ÏÏ- 1
<
ÏÏ1 2
BoletaDePago
ÏÏ2 >
>
ÏÏ> ?
(
ÏÏ? @
)
ÏÏ@ A
;
ÏÏA B
foreach
ÌÌ 
(
ÌÌ 
Contrato
ÌÌ 
contrato
ÌÌ &
in
ÌÌ' )$
listaContratosFiltrada
ÌÌ* @
)
ÌÌ@ A
{
ÓÓ 
BoletaDePago
 
boleta
 #
=
$ %
new
& )
BoletaDePago
* 6
{
ÒÒ 
Contrato
ÚÚ 
=
ÚÚ 
contrato
ÚÚ '
,
ÚÚ' (
Nomina
ÛÛ 
=
ÛÛ 
Nomina
ÛÛ #
}
ÙÙ 
;
ÙÙ 
boletas
ıı 
.
ıı 
Add
ıı 
(
ıı 
boleta
ıı "
)
ıı" #
;
ıı# $
}
˜˜ 
return
˘˘ 
boletas
˘˘ 
;
˘˘ 
}
˚˚ 	
private
˝˝ 
void
˝˝  
generarPagosBoleta
˝˝ '
(
˝˝' (
)
˝˝( )
{
˛˛ 	$
dataGridViewListaPagos
ÇÇ "
.
ÇÇ" #
Rows
ÇÇ# '
.
ÇÇ' (
Clear
ÇÇ( -
(
ÇÇ- .
)
ÇÇ. /
;
ÇÇ/ 0$
dataGridViewListaPagos
ÉÉ "
.
ÉÉ" #
Rows
ÉÉ# '
.
ÉÉ' (
Add
ÉÉ( +
(
ÉÉ+ ,
Nomina
ÉÉ, 2
.
ÉÉ2 3
BoletaDePagos
ÉÉ3 @
.
ÉÉ@ A
Count
ÉÉA F
)
ÉÉF G
;
ÉÉG H
int
ÑÑ 
rowEscribir
ÑÑ 
=
ÑÑ 
$num
ÑÑ 
;
ÑÑ  
foreach
ÖÖ 
(
ÖÖ 
BoletaDePago
ÖÖ !
boleta
ÖÖ" (
in
ÖÖ) +
Nomina
ÖÖ, 2
.
ÖÖ2 3
BoletaDePagos
ÖÖ3 @
)
ÖÖ@ A
{
ÜÜ !
calcularDatosBoleta
ââ #
(
ââ# $
boleta
ââ$ *
)
ââ* +
;
ââ+ ,$
dataGridViewListaPagos
ää &
.
ää& '
Rows
ää' +
[
ää+ ,
rowEscribir
ää, 7
]
ää7 8
.
ää8 9
Cells
ää9 >
[
ää> ?
$num
ää? @
]
ää@ A
.
ääA B
Value
ääB G
=
ääH I
boleta
ääJ P
.
ääP Q
Contrato
ääQ Y
.
ääY Z
Empleado
ääZ b
.
ääb c
Empleado_id
ääc n
;
ään o$
dataGridViewListaPagos
ãã &
.
ãã& '
Rows
ãã' +
[
ãã+ ,
rowEscribir
ãã, 7
]
ãã7 8
.
ãã8 9
Cells
ãã9 >
[
ãã> ?
$num
ãã? @
]
ãã@ A
.
ããA B
Value
ããB G
=
ããH I
boleta
ããJ P
.
ããP Q
Contrato
ããQ Y
.
ããY Z
Contrato_id
ããZ e
;
ããe f$
dataGridViewListaPagos
åå &
.
åå& '
Rows
åå' +
[
åå+ ,
rowEscribir
åå, 7
]
åå7 8
.
åå8 9
Cells
åå9 >
[
åå> ?
$num
åå? @
]
åå@ A
.
ååA B
Value
ååB G
=
ååH I
boleta
ååJ P
.
ååP Q
Contrato
ååQ Y
.
ååY Z
Empleado
ååZ b
.
ååb c
Nombres
ååc j
+
ååk l
$str
ååm p
+
ååq r
boleta
åås y
.
ååy z
Contratoååz Ç
.ååÇ É
EmpleadoååÉ ã
.ååã å
	Apellidosååå ï
;ååï ñ$
dataGridViewListaPagos
çç &
.
çç& '
Rows
çç' +
[
çç+ ,
rowEscribir
çç, 7
]
çç7 8
.
çç8 9
Cells
çç9 >
[
çç> ?
$num
çç? @
]
çç@ A
.
ççA B
Value
ççB G
=
ççH I
boleta
ççJ P
.
ççP Q
Contrato
ççQ Y
.
ççY Z
Puesto
ççZ `
;
çç` a$
dataGridViewListaPagos
éé &
.
éé& '
Rows
éé' +
[
éé+ ,
rowEscribir
éé, 7
]
éé7 8
.
éé8 9
Cells
éé9 >
[
éé> ?
$num
éé? @
]
éé@ A
.
ééA B
Value
ééB G
=
ééH I
boleta
ééJ P
.
ééP Q#
CalcularTotalIngresos
ééQ f
(
ééf g
)
éég h
.
ééh i
ToString
ééi q
(
ééq r
)
éér s
;
éés t$
dataGridViewListaPagos
èè &
.
èè& '
Rows
èè' +
[
èè+ ,
rowEscribir
èè, 7
]
èè7 8
.
èè8 9
Cells
èè9 >
[
èè> ?
$num
èè? @
]
èè@ A
.
èèA B
Value
èèB G
=
èèH I
boleta
èèJ P
.
èèP Q&
CalcularTotalRetenciones
èèQ i
(
èèi j
)
èèj k
.
èèk l
ToString
èèl t
(
èèt u
)
èèu v
;
èèv w$
dataGridViewListaPagos
êê &
.
êê& '
Rows
êê' +
[
êê+ ,
rowEscribir
êê, 7
]
êê7 8
.
êê8 9
Cells
êê9 >
[
êê> ?
$num
êê? @
]
êê@ A
.
êêA B
Value
êêB G
=
êêH I
boleta
êêJ P
.
êêP Q 
CalcularNetoAPagar
êêQ c
(
êêc d
)
êêd e
.
êêe f
ToString
êêf n
(
êên o
)
êêo p
;
êêp q
rowEscribir
íí 
++
íí 
;
íí 
}
ìì #
calcularTotalesNomina
ññ !
(
ññ! "
)
ññ" #
;
ññ# $
}
ôô 	
public
úú 
void
úú #
calcularTotalesNomina
úú )
(
úú) *
)
úú* +
{
ùù 	#
textBoxTotalGenerados
°° !
.
°°! "
Text
°°" &
=
°°' (
Nomina
°°) /
.
°°/ 0
BoletaDePagos
°°0 =
.
°°= >
Count
°°> C
.
°°C D
ToString
°°D L
(
°°L M
)
°°M N
;
°°N O"
textBoxTotalIngresos
¢¢  
.
¢¢  !
Text
¢¢! %
=
¢¢& '
Nomina
¢¢( .
.
¢¢. /)
calcularTotalIngresosNomina
¢¢/ J
(
¢¢J K
)
¢¢K L
.
¢¢L M
ToString
¢¢M U
(
¢¢U V
)
¢¢V W
;
¢¢W X%
textBoxTotalRetenciones
££ #
.
££# $
Text
££$ (
=
££) *
Nomina
££+ 1
.
££1 2,
calcularTotalRetencionesNomina
££2 P
(
££P Q
)
££Q R
.
££R S
ToString
££S [
(
££[ \
)
££\ ]
;
££] ^#
textBoxTotalNetoPagar
§§ !
.
§§! "
Text
§§" &
=
§§' (
Nomina
§§) /
.
§§/ 0+
calcularTotalSueldoNetoNomina
§§0 M
(
§§M N
)
§§N O
.
§§O P
ToString
§§P X
(
§§X Y
)
§§Y Z
;
§§Z [
}
¶¶ 	
private
®® 
void
®® !
calcularDatosBoleta
®® (
(
®®( )
BoletaDePago
®®) 5
boleta
®®6 <
)
®®< =
{
©© 	
boleta
™™ 
.
™™ "
CalcularSueldoBasico
™™ '
(
™™' (
)
™™( )
;
™™) *
boleta
´´ 
.
´´ -
CalcularMontoAsignacionFamiliar
´´ 2
(
´´2 3
)
´´3 4
;
´´4 5
boleta
¨¨ 
.
¨¨ )
CalcularMontoPorHorasExtras
¨¨ .
(
¨¨. /
)
¨¨/ 0
;
¨¨0 1
boleta
≠≠ 
.
≠≠ (
CalcularRegimenPensionario
≠≠ -
(
≠≠- .
)
≠≠. /
;
≠≠/ 0
boleta
ÆÆ 
.
ÆÆ %
CalcularMontoHorasFalta
ÆÆ *
(
ÆÆ* +
)
ÆÆ+ ,
;
ÆÆ, -
}
∞∞ 	
private
¥¥ 
void
¥¥  
limpiarDatosNomina
¥¥ '
(
¥¥' (
)
¥¥( )
{
µµ 	$
dataGridViewListaPagos
∂∂ "
.
∂∂" #
Rows
∂∂# '
.
∂∂' (
Clear
∂∂( -
(
∂∂- .
)
∂∂. /
;
∂∂/ 0&
textBoxDescripcionNomina
∑∑ $
.
∑∑$ %
Text
∑∑% )
=
∑∑* +
$str
∑∑, .
;
∑∑. /#
textBoxTotalGenerados
∏∏ !
.
∏∏! "
Text
∏∏" &
=
∏∏' (
$str
∏∏) +
;
∏∏+ ,"
textBoxTotalIngresos
ππ  
.
ππ  !
Text
ππ! %
=
ππ& '
$str
ππ( *
;
ππ* +%
textBoxTotalRetenciones
∫∫ #
.
∫∫# $
Text
∫∫$ (
=
∫∫) *
$str
∫∫+ -
;
∫∫- .#
textBoxTotalNetoPagar
ªª !
.
ªª! "
Text
ªª" &
=
ªª' (
$str
ªª) +
;
ªª+ ,
Nomina
ºº 
=
ºº 
null
ºº 
;
ºº 
}
ææ 	
private
¿¿ 
void
¿¿  
buttonCerrar_Click
¿¿ '
(
¿¿' (
object
¿¿( .
sender
¿¿/ 5
,
¿¿5 6
	EventArgs
¿¿7 @
e
¿¿A B
)
¿¿B C
{
¡¡ 	
try
¬¬ 
{
√√ 
if
ƒƒ 
(
ƒƒ 

MessageBox
ƒƒ 
.
ƒƒ 
Show
ƒƒ #
(
ƒƒ# $
$strƒƒ$ ´
,ƒƒ´ ¨
$strƒƒ≠ ∫
,ƒƒ∫ ª!
MessageBoxButtonsƒƒº Õ
.ƒƒÕ Œ
OKCancelƒƒŒ ÷
)ƒƒ÷ ◊
==ƒƒÿ ⁄
DialogResultƒƒ€ Á
.ƒƒÁ Ë
OKƒƒË Í
)ƒƒÍ Î
{
≈≈ $
procesarNominaServicio
«« *
.
««* +
cerrar
««+ 1
(
««1 2
Nomina
««2 8
)
««8 9
;
««9 : 
limpiarDatosNomina
»» &
(
»»& '
)
»»' (
;
»»( )
buttonEliminar
…… "
.
……" #
Enabled
……# *
=
……+ ,
false
……- 2
;
……2 3
buttonCerrar
    
.
    !
Enabled
  ! (
=
  ) *
false
  + 0
;
  0 1
buttonCrearNomina
ÀÀ %
.
ÀÀ% &
Enabled
ÀÀ& -
=
ÀÀ. /
true
ÀÀ0 4
;
ÀÀ4 5 
buttonBuscarNomina
ÃÃ &
.
ÃÃ& '
Enabled
ÃÃ' .
=
ÃÃ/ 0
true
ÃÃ1 5
;
ÃÃ5 6

MessageBox
ÕÕ 
.
ÕÕ 
Show
ÕÕ #
(
ÕÕ# $
$str
ÕÕ$ o
)
ÕÕo p
;
ÕÕp q
}
ŒŒ 
}
–– 
catch
—— 
(
—— 
	Exception
—— 
err
——  
)
——  !
{
““ 

MessageBox
‘‘ 
.
‘‘ 
Show
‘‘ 
(
‘‘  
err
‘‘  #
.
‘‘# $
Message
‘‘$ +
)
‘‘+ ,
;
‘‘, -
}
’’ 
}
◊◊ 	
private
ŸŸ 
void
ŸŸ "
buttonEliminar_Click
ŸŸ )
(
ŸŸ) *
object
ŸŸ* 0
sender
ŸŸ1 7
,
ŸŸ7 8
	EventArgs
ŸŸ9 B
e
ŸŸC D
)
ŸŸD E
{
⁄⁄ 	
try
€€ 
{
‹‹ 
if
›› 
(
›› 

MessageBox
›› 
.
›› 
Show
›› #
(
››# $
$str››$ î
,››î ï
$str››ñ £
,››£ §!
MessageBoxButtons››• ∂
.››∂ ∑
OKCancel››∑ ø
)››ø ¿
==››¡ √
DialogResult››ƒ –
.››– —
OK››— ”
)››” ‘
{
ﬁﬁ 
if
ﬂﬂ 
(
ﬂﬂ 
!
ﬂﬂ 
Nomina
ﬂﬂ 
.
ﬂﬂ  
Cerrada
ﬂﬂ  '
)
ﬂﬂ' (
{
‡‡ $
procesarNominaServicio
‚‚ .
.
‚‚. /
eliminar
‚‚/ 7
(
‚‚7 8
this
‚‚8 <
.
‚‚< =
Nomina
‚‚= C
)
‚‚C D
;
‚‚D E 
limpiarDatosNomina
„„ *
(
„„* +
)
„„+ ,
;
„„, -
buttonEliminar
‰‰ &
.
‰‰& '
Enabled
‰‰' .
=
‰‰/ 0
false
‰‰1 6
;
‰‰6 7
buttonCerrar
ÂÂ $
.
ÂÂ$ %
Enabled
ÂÂ% ,
=
ÂÂ- .
false
ÂÂ/ 4
;
ÂÂ4 5
buttonCrearNomina
ÁÁ )
.
ÁÁ) *
Enabled
ÁÁ* 1
=
ÁÁ2 3
true
ÁÁ4 8
;
ÁÁ8 9 
buttonBuscarNomina
ËË *
.
ËË* +
Enabled
ËË+ 2
=
ËË3 4
true
ËË5 9
;
ËË9 :

MessageBox
ÈÈ "
.
ÈÈ" #
Show
ÈÈ# '
(
ÈÈ' (
$str
ÈÈ( >
)
ÈÈ> ?
;
ÈÈ? @
}
ÎÎ 
else
ÏÏ 
{
ÌÌ 

MessageBox
ÓÓ "
.
ÓÓ" #
Show
ÓÓ# '
(
ÓÓ' (
$str
ÓÓ( Z
)
ÓÓZ [
;
ÓÓ[ \
}
ÔÔ 
}
ÚÚ 
}
ÙÙ 
catch
ıı 
(
ıı 
	Exception
ıı 
err
ıı  
)
ıı  !
{
ˆˆ 

MessageBox
¯¯ 
.
¯¯ 
Show
¯¯ 
(
¯¯  
err
¯¯  #
.
¯¯# $
Message
¯¯$ +
)
¯¯+ ,
;
¯¯, - 
limpiarDatosNomina
˘˘ "
(
˘˘" #
)
˘˘# $
;
˘˘$ %
buttonEliminar
˙˙ 
.
˙˙ 
Enabled
˙˙ &
=
˙˙' (
false
˙˙) .
;
˙˙. /
buttonCerrar
˚˚ 
.
˚˚ 
Enabled
˚˚ $
=
˚˚% &
false
˚˚' ,
;
˚˚, -
buttonCrearNomina
˝˝ !
.
˝˝! "
Enabled
˝˝" )
=
˝˝* +
true
˝˝, 0
;
˝˝0 1 
buttonBuscarNomina
˛˛ "
.
˛˛" #
Enabled
˛˛# *
=
˛˛+ ,
true
˛˛- 1
;
˛˛1 2
}
ˇˇ 
}
ÄÄ 	
}
ÅÅ 
}ÇÇ æ
}C:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Nominas\FormRegistrarPeriodoDeNomina.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
Nominas& -
{ 
public 

partial 
class (
FormRegistrarPeriodoDeNomina 5
:6 7
Form8 <
{ 
private *
GestionarPeriodoNominaServicio .!
periodoNominaServicio/ D
;D E
public (
FormRegistrarPeriodoDeNomina +
(+ ,
), -
{ 	
InitializeComponent 
(  
)  !
;! "!
periodoNominaServicio !
=" #
new$ '*
GestionarPeriodoNominaServicio( F
(F G
)G H
;H I
} 	
private 
void 
button1_Click "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
PeriodoDeNomina 
periodoNomina )
=* +
new, /
PeriodoDeNomina0 ?
(? @
)@ A
;A B
periodoNomina 
. 
Descripcion %
=& '
textBox1( 0
.0 1
Text1 5
;5 6
periodoNomina 
. 
Fechainicio %
=& '
dateTimePicker1( 7
.7 8
Value8 =
;= >
periodoNomina 
. 
Fechafin "
=# $
dateTimePicker2% 4
.4 5
Value5 :
;: ;
try   
{!! 
if$$ 
($$ 
periodoNomina$$ !
.$$! "
tieneFechaFinValida$$" 5
($$5 6
)$$6 7
)$$7 8
{%% !
periodoNominaServicio'' )
.'') *"
guardarPeriodoDeNomina''* @
(''@ A
periodoNomina''A N
)''N O
;''O P

MessageBox(( 
.(( 
Show(( #
(((# $
this(($ (
,((( )
$str((* L
)((L M
;((M N
this)) 
.)) 
Dispose))  
())  !
)))! "
;))" #
}** 
else++ 
{,, 

MessageBox-- 
.-- 
Show-- #
(--# $
this--$ (
,--( )
$str--* [
)--[ \
;--\ ]
}.. 
}11 
catch22 
(22 
	Exception22 
err22  
)22  !
{33 

MessageBox44 
.44 
Show44 
(44  
this44  $
,44$ %
$str44& /
+440 1
err442 5
.445 6
Message446 =
)44= >
;44> ?
}55 
}66 	
private88 
void88 
button2_Click88 "
(88" #
object88# )
sender88* 0
,880 1
	EventArgs882 ;
e88< =
)88= >
{99 	
this:: 
.:: 
Dispose:: 
(:: 
):: 
;:: 
};; 	
}>> 
}?? ©
oC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Otros\FormAFPPrincipal.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
Otros& +
{ 
public 

partial 
class 
FormAFPPrincipal )
:* +
Form, 0
{ 
private  
GestionarAfpServicio $ 
gestionarAfpServicio% 9
;9 :
public 
FormAFPPrincipal 
(  
)  !
{ 	
InitializeComponent 
(  
)  !
;! " 
gestionarAfpServicio  
=! "
new# & 
GestionarAfpServicio' ;
(; <
)< =
;= >
} 	
private 
void !
buttonRegistrar_Click *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
FormRegistrarAfp 
formRegistrarAfp -
=. /
new0 3
FormRegistrarAfp4 D
(D E
)E F
;F G
formRegistrarAfp 
. 

ShowDialog '
(' (
this( ,
), -
;- .
} 	
private   
void   
cargarListaAfp   #
(  # $
)  $ %
{!! 	
List"" 
<"" 
Afp"" 
>"" 
listaAfp"" 
;"" 
try## 
{$$ 
listaAfp%% 
=%%  
gestionarAfpServicio%% /
.%%/ 0
obtenerListaAfp%%0 ?
(%%? @
)%%@ A
;%%A B
int&& 
rowEscribir&& 
=&&  !
$num&&" #
;&&# $
dataGridView1'' 
.'' 
Rows'' "
.''" #
Clear''# (
(''( )
)'') *
;''* +
dataGridView1(( 
.(( 
Rows(( "
.((" #
Add((# &
(((& '
listaAfp((' /
.((/ 0
Count((0 5
)((5 6
;((6 7
foreach** 
(** 
Afp** 
item** !
in**" $
listaAfp**% -
)**- .
{++ 
dataGridView1,, !
.,,! "
Rows,," &
[,,& '
rowEscribir,,' 2
],,2 3
.,,3 4
Cells,,4 9
[,,9 :
$num,,: ;
],,; <
.,,< =
Value,,= B
=,,C D
item,,E I
.,,I J
Afp_id,,J P
;,,P Q
dataGridView1-- !
.--! "
Rows--" &
[--& '
rowEscribir--' 2
]--2 3
.--3 4
Cells--4 9
[--9 :
$num--: ;
]--; <
.--< =
Value--= B
=--C D
item--E I
.--I J
Nombre--J P
;--P Q
dataGridView1.. !
...! "
Rows.." &
[..& '
rowEscribir..' 2
]..2 3
...3 4
Cells..4 9
[..9 :
$num..: ;
]..; <
...< =
Value..= B
=..C D
item..E I
...I J
Porcentajedescuento..J ]
;..] ^
rowEscribir// 
++// !
;//! "
}11 
}22 
catch33 
(33 
	Exception33 
err33  
)33  !
{44 

MessageBox66 
.66 
Show66 
(66  
this66  $
,66$ %
err66& )
.66) *
Message66* 1
)661 2
;662 3
}77 
}== 	
private?? 
void?? !
buttonCargarAfp_Click?? *
(??* +
object??+ 1
sender??2 8
,??8 9
	EventArgs??: C
e??D E
)??E F
{@@ 	
cargarListaAfpAA 
(AA 
)AA 
;AA 
}BB 	
}CC 
}DD ﬁ
oC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Otros\FormRegistrarAfp.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
Otros& +
{ 
public 

partial 
class 
FormRegistrarAfp )
:* +
Form, 0
{ 
private 
readonly  
GestionarAfpServicio -
afpServicio. 9
;9 :
public 
FormRegistrarAfp 
(  
)  !
{ 	
InitializeComponent 
(  
)  !
;! "
afpServicio 
= 
new  
GestionarAfpServicio 2
(2 3
)3 4
;4 5
} 	
private 
void 
button1_Click "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
Afp 
afp 
= 
new 
Afp 
( 
) 
;  
afp 
. 
Afp_id 
= 
int 
. 
Parse "
(" #
textBoxIdAfp$ 0
.0 1
Text1 5
)5 6
;6 7
afp 
. 
Nombre 
= 
textBoxNombreAfp )
.) *
Text* .
;. /
afp 
. 
Porcentajedescuento #
=$ %
Convert& -
.- .
ToDouble. 6
(6 7&
textBoxPorcentajeDescuento7 Q
.Q R
TextR V
)V W
;W X
try!! 
{"" 
afpServicio## 
.## 

guardarAfp## &
(##& '
afp##' *
)##* +
;##+ ,

MessageBox$$ 
.$$ 
Show$$ 
($$  
this$$  $
,$$$ %
$str$$& H
)$$H I
;$$I J
this%% 
.%% 
Dispose%% 
(%% 
)%% 
;%% 
}&& 
catch'' 
('' 
	Exception'' 
err''  
)''  !
{(( 

MessageBox)) 
.)) 
Show)) 
())  
this))  $
,))$ %
$str))& /
+))0 1
err))2 5
.))5 6
Message))6 =
)))= >
;))> ?
}** 
}++ 	
private-- 
void-- 
button2_Click-- "
(--" #
object--# )
sender--* 0
,--0 1
	EventArgs--2 ;
e--< =
)--= >
{.. 	
this// 
.// 
Dispose// 
(// 
)// 
;// 
}00 	
}11 
}22 «f
vC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Otros\FormRegistrarIncidencia.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
.% &
Otros& +
{ 
public 

partial 
class #
FormRegistrarIncidencia 0
:1 2
Form3 7
{ 
private 
readonly *
GestionarPeriodoNominaServicio 7
periodoServicio8 G
;G H
private 
readonly %
GestionarEmpleadoServicio 2
empleadoServicio3 C
;C D
private 
readonly .
"GestionarIncidenciaLaboralServicio ;%
incidenciaLaboralServicio< U
;U V
private 
readonly %
GestionarContratoServicio 2
contratoServicio3 C
;C D
private 
List 
< 
PeriodoDeNomina $
>$ %
ListaPeriodo& 2
{3 4
get5 8
;8 9
set: =
;= >
}? @
private 
Empleado 
Empleado !
{" #
get$ '
;' (
set) ,
;, -
}. /
private 
Contrato 
Contrato !
{" #
get$ '
;' (
set) ,
;, -
}. /
public #
FormRegistrarIncidencia &
(& '
)' (
{ 	
InitializeComponent 
(  
)  !
;! "
periodoServicio 
= 
new !*
GestionarPeriodoNominaServicio" @
(@ A
)A B
;B C%
incidenciaLaboralServicio %
=& '
new( +.
"GestionarIncidenciaLaboralServicio, N
(N O
)O P
;P Q
empleadoServicio 
= 
new "%
GestionarEmpleadoServicio# <
(< =
)= >
;> ?
contratoServicio   
=   
new   "%
GestionarContratoServicio  # <
(  < =
)  = >
;  > ?
panelIngresoHoras!! 
.!! 
Visible!! %
=!!& '
false!!( -
;!!- .
}"" 	
private$$ 
void$$ 
cargarDatosContrato$$ (
($$( )
)$$) *
{%% 	
labelIdContrato'' 
.'' 
Text''  
=''! "
Contrato''# +
.''+ ,
Contrato_id'', 7
;''7 8
if(( 
((( 
Contrato(( 
.(( 
EstaVigente(( $
((($ %
)((% &
)((& '
{)) 
labelEstado** 
.** 
Text**  
=**! "
$str**# ,
;**, -
}++ 

labelFecha,, 
.,, 
Text,, 
=,, 
Contrato,, &
.,,& '
Fechafin,,' /
.,,/ 0
ToShortDateString,,0 A
(,,A B
),,B C
;,,C D
panelIngresoHoras-- 
.-- 
Visible-- %
=--& '
true--( ,
;--, -
cargarListaPeriodo.. 
(.. 
)..  
;..  !
}00 	
private22 
void22 
cargarListaPeriodo22 '
(22' (
)22( )
{33 	
try44 
{55 
ListaPeriodo66 
=66 
periodoServicio66 .
.66. /
obtenerListaPeriodo66/ B
(66B C
)66C D
;66D E
}77 
catch88 
(88 
	Exception88 
err88  
)88  !
{99 

MessageBox;; 
.;; 
Show;; 
(;;  
$str;;  1
+;;2 3
err;;4 7
.;;7 8
Message;;8 ?
);;? @
;;;@ A
}<< 
if>> 
(>> 
ListaPeriodo>> 
.>> 
Count>> "
>>># $
$num>>% &
)>>& '
{?? 
comboBoxPeriodo@@ 
.@@  
Items@@  %
.@@% &
Clear@@& +
(@@+ ,
)@@, -
;@@- .
foreachBB 
(BB 
PeriodoDeNominaBB (
itemBB) -
inBB. 0
ListaPeriodoBB1 =
)BB= >
{CC 
comboBoxPeriodoDD #
.DD# $
ItemsDD$ )
.DD) *
AddDD* -
(DD- .
itemDD. 2
.DD2 3
DescripcionDD3 >
)DD> ?
;DD? @
}FF 
comboBoxPeriodoGG 
.GG  
TextGG  $
=GG% &
ListaPeriodoGG' 3
[GG3 4
$numGG4 5
]GG5 6
.GG6 7
DescripcionGG7 B
;GGB C
}II 
elseJJ 
{KK 

MessageBoxLL 
.LL 
ShowLL 
(LL  
thisLL  $
,LL$ %
$strLL& C
)LLC D
;LLD E
}MM 
}SS 	
privateUU 
voidUU 
Guardar_ClickUU "
(UU" #
objectUU# )
senderUU* 0
,UU0 1
	EventArgsUU2 ;
eUU< =
)UU= >
{VV 	
tryZZ 
{[[ 
IncidenciaLaboral\\ !
incidenciaLaboral\\" 3
=\\4 5
new\\6 9
IncidenciaLaboral\\: K
(\\K L
)\\L M
;\\M N
incidenciaLaboral__ !
.__! "
Periodo__" )
=__* +
buscarPeriodo__, 9
(__9 :
)__: ;
;__; <
string`` 
	horaExtra``  
=``! "#
textBoxTotalHorasExtras``# :
.``: ;
Text``; ?
;``? @
stringaa 
	horaFaltaaa  
=aa! ""
textBoxTotalHorasFaltaaa# 9
.aa9 :
Textaa: >
;aa> ?
ifdd 
(dd 
validarDatosdd  
(dd  !
	horaExtradd! *
,dd* +
	horaFaltadd, 5
)dd5 6
&&dd7 9
incidenciaLaboraldd: K
.ddK L
PeriododdL S
!=ddT V
nullddW [
)dd[ \
{ee 
incidenciaLaboralgg %
.gg% &
Incidencia_idgg& 3
=gg4 5
DateTimegg7 ?
.gg? @
Nowgg@ C
.ggC D
MillisecondggD O
*ggP Q
DateTimeggR Z
.ggZ [
Nowgg[ ^
.gg^ _
Secondgg_ e
;gge f
incidenciaLaboralhh %
.hh% &
Totalhorasdefaltahh& 7
=hh8 9
Converthh: A
.hhA B
ToInt32hhB I
(hhI J
	horaExtrahhJ S
)hhS T
;hhT U
incidenciaLaboralii %
.ii% &
Totalhorasextrasii& 6
=ii7 8
Convertii9 @
.ii@ A
ToInt32iiA H
(iiH I
	horaFaltaiiI R
)iiR S
;iiS T
incidenciaLaboraljj %
.jj% &
Contratojj& .
=jj/ 0
Contratojj1 9
;jj9 :
ifll 
(ll 
textBoxDniEmpleadoll *
.ll* +
Textll+ /
.ll/ 0
Equalsll0 6
(ll6 7
Empleadoll7 ?
.ll? @
Dnill@ C
)llC D
)llD E
{mm %
incidenciaLaboralServicionn 1
.nn1 2
guardarnn2 9
(nn9 :
incidenciaLaboralnn: K
)nnK L
;nnL M

MessageBoxoo "
.oo" #
Showoo# '
(oo' (
thisoo( ,
,oo, -
$stroo. P
)ooP Q
;ooQ R
thispp 
.pp 
Disposepp $
(pp$ %
)pp% &
;pp& '
}qq 
elserr 
{ss 

MessageBoxuu "
.uu" #
Showuu# '
(uu' (
thisuu( ,
,uu, -
$struu. [
)uu[ \
;uu\ ]
}vv 
}yy 
elsezz 
{zz 

MessageBox|| 
.|| 
Show|| #
(||# $
this||$ (
,||( )
$str||) K
)||K L
;||L M
}}} 
} 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
err
ÄÄ  
)
ÄÄ  !
{
ÅÅ 

MessageBox
ÇÇ 
.
ÇÇ 
Show
ÇÇ 
(
ÇÇ  
this
ÇÇ  $
,
ÇÇ$ %
$str
ÇÇ& /
+
ÇÇ0 1
err
ÇÇ2 5
.
ÇÇ5 6
Message
ÇÇ6 =
)
ÇÇ= >
;
ÇÇ> ?
}
ÉÉ 
}
ÑÑ 	
bool
ââ 
validarDatos
ââ 
(
ââ 
string
ââ  
	horaExtra
ââ! *
,
ââ* +
string
ââ, 2
	horaFalta
ââ3 <
)
ââ< =
{
ää 	
if
çç 
(
çç 
(
çç 
	horaExtra
çç 
.
çç 
Trim
çç 
(
çç  
)
çç  !
.
çç! "
Length
çç" (
>
çç) *
$num
çç+ ,
&&
çç- /
	horaFalta
çç0 9
.
çç9 :
Trim
çç: >
(
çç> ?
)
çç? @
.
çç@ A
Length
ççA G
>
ççH I
$num
ççJ K
)
ççK L
&&
ççM O
(
ççP Q
esSoloDigitos
ççQ ^
(
çç^ _
	horaExtra
çç_ h
)
ççh i
&&
ççj l
esSoloDigitos
ççm z
(
ççz {
	horaFaltaçç{ Ñ
)ççÑ Ö
)ççÖ Ü
)ççÜ á
{
éé 
return
èè 
true
èè 
;
èè 
}
êê 
return
íí 
false
íí 
;
íí 
}
ìì 	
private
óó 
void
óó *
buttonBuscarEmpleado_Click_1
óó 1
(
óó1 2
object
óó2 8
sender
óó9 ?
,
óó? @
	EventArgs
óóA J
e
óóK L
)
óóL M
{
òò 	
try
õõ 
{
úú 
string
ùù 
dni
ùù 
=
ùù  
textBoxDniEmpleado
ùù /
.
ùù/ 0
Text
ùù0 4
.
ùù4 5
Trim
ùù5 9
(
ùù9 :
)
ùù: ;
;
ùù; <
if
ûû 
(
ûû 
esSoloDigitos
ûû !
(
ûû! "
dni
ûû" %
)
ûû% &
)
ûû& '
{
üü 
Empleado
†† 
empleadoAux
†† (
=
††) *
empleadoServicio
††+ ;
.
††; <"
buscarEmpleadoPorDni
††< P
(
††P Q
dni
††Q T
)
††T U
;
††U V
this
°° 
.
°° 
Empleado
°° !
=
°°" #
empleadoAux
°°$ /
;
°°/ 0
Contrato
¢¢ 
contratoAux
¢¢ (
=
¢¢) *
contratoServicio
¢¢+ ;
.
¢¢; <0
"buscarContratoVigentePorIdEmpleado
¢¢< ^
(
¢¢^ _
$str
¢¢_ d
+
¢¢e f
this
¢¢g k
.
¢¢k l
Empleado
¢¢l t
.
¢¢t u
Dni
¢¢u x
)
¢¢x y
;
¢¢y z
this
££ 
.
££ 
Contrato
££ !
=
££" #
contratoAux
££$ /
;
££/ 0!
cargarDatosContrato
§§ '
(
§§' (
)
§§( )
;
§§) *
}
•• 
else
¶¶ 
{
ßß 

MessageBox
®® 
.
®® 
Show
®® #
(
®®# $
$str
®®$ C
)
®®C D
;
®®D E
}
©© 
}
´´ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
err
¨¨  
)
¨¨  !
{
≠≠ 

MessageBox
ØØ 
.
ØØ 
Show
ØØ 
(
ØØ  
this
ØØ  $
,
ØØ$ %
$str
ØØ& 1
+
ØØ2 3
err
ØØ4 7
.
ØØ7 8
Message
ØØ8 ?
)
ØØ? @
;
ØØ@ A
}
∞∞ 
}
±± 	
PeriodoDeNomina
≥≥ 
buscarPeriodo
≥≥ %
(
≥≥% &
)
≥≥& '
{
¥¥ 	
foreach
∑∑ 
(
∑∑ 
PeriodoDeNomina
∑∑ $
item
∑∑% )
in
∑∑* ,
ListaPeriodo
∑∑- 9
)
∑∑9 :
{
∏∏ 
if
ππ 
(
ππ 
comboBoxPeriodo
ππ #
.
ππ# $
Text
ππ$ (
.
ππ( )
Equals
ππ) /
(
ππ/ 0
item
ππ0 4
.
ππ4 5
Descripcion
ππ5 @
)
ππ@ A
)
ππA B
{
∫∫ 
return
ªª 
item
ªª 
;
ªª  
}
ΩΩ 
}
ææ 
return
øø 
null
øø 
;
øø 
}
¡¡ 	
private
ƒƒ 
bool
ƒƒ 
esSoloDigitos
ƒƒ "
(
ƒƒ" #
string
ƒƒ# )
cadena
ƒƒ* 0
)
ƒƒ0 1
{
≈≈ 	
if
∆∆ 
(
∆∆ 
cadena
∆∆ 
.
∆∆ 
All
∆∆ 
(
∆∆ 
char
∆∆ 
.
∆∆  
IsDigit
∆∆  '
)
∆∆' (
)
∆∆( )
{
«« 
return
»» 
true
»» 
;
»» 
}
…… 
return
   
false
   
;
   
}
ÀÀ 	
}
ÃÃ 
}ÕÕ ô
`C:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Program.cs
	namespace 	
Capa1_Presentacion
 
. 
WinForms %
{		 
static

 

class

 
Program

 
{ 
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
) 
{ 	
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
Application 
. 
Run 
( 
new 
FormIniciarSesion  1
(1 2
)2 3
)3 4
;4 5
} 	
} 
} õ
pC:\Users\Rover\OneDrive\Documentos\GitHub\CAPS-NominaSoft\Capa1_Presentacion.WinForms\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 6
)6 7
]7 8
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 8
)8 9
]9 :
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *